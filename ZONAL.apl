    ∇ Z←F ZONAL X;D;B;C[1]   ⍝Apply function ⍺ (default is 'SUM') across all cells of ⍵[1] in each zone defined by ⍵[2][2]   ⍝Zeros and MV are not treated as zones[3]   ⍝⍺ may be SUM, MIN, MAX, MEAN (or whatever pXXX functions are available)[4]   ⍝B. Compton, 8 Jun 2011[5]   [6]   [7]   [8]    ⍎(0=⎕NC'F')/'F←''SUM'''[9]    D←(B/,2⊃X),[1.5](B←,~(2⊃X)∊0,MV)/,1⊃X  ⍝Get zones and values[10]   D←(D[;2]≠MV)⌿D                         ⍝Drop missing rows[11]   D←D[⍋D[;1];][12]   C←D[;1]≠0,¯1↓D[;1]                     ⍝Partition vector[13]   ⍎'Z←C p',F,' D[;2]'                    ⍝Partitioned sum/min/max[14]   Z←(Z,MV)[(C/D[;1])⍳2⊃X]                ⍝Index to get result    ∇