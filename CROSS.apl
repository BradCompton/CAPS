    ∇ Z←P CROSS S;I;U;B1;B2;A1;A2;XI;YI[1]   ⍝Return 1 for each line segment in ⍵ crossed by line segment ⍺[2]   ⍝Source: http://www.geog.ubc.ca/courses/klink/gis.notes/ncgia/u32.html#SEC32.3.4[3]   ⍝B. Compton, ca 2002[4]   ⍝17 Feb 2010, deal with orthogonal lines[5]   [6]   [7]    Z←⍳0[8]    I←0[9]   L1:→((1↑⍴S)<I←I+1)/0[10]   U←2 2⍴S[I;][11]   U[1;]←U[1;]+1E¯2×=⌿U            ⍝Knock lines out of perfect horizontal/vertical to avoid ÷0[12]   P[1;]←P[1;]+1E¯2×=⌿P[13]   B1←(-/P[2 1;2])÷-/P[2 1;1][14]   B2←(-/U[2 1;2])÷-/U[2 1;1][15]   A1←P[1;2]-B1×P[1;1][16]   A2←U[1;2]-B2×U[1;1][17]   XI←-(A1-A2)÷B1-B2+.0001×B1=B2   ⍝Add tiny number if lines are parallel[18]   YI←A1+B1×XI[19]   Z←Z,(((P[1;1]-XI)×XI-P[2;1])≥0)^(((U[1;1]-XI)×(XI-U[2;1]))≥0)^(((P[1;2]-YI)×YI-P[2;2])≥0)^((U[1;2]-YI)×YI-U[2;2])≥0[20]   →L1    ∇