    ∇ Z←A FINDDITCHES F;X;Y;B;E;F;I;Q;K;W;L;Y;N;atol;minlength;head;T;V;J;D;S;C;stol;P[1]   ⍝Identify straight lines (= ditches) in set of line segments in file ⍵, given minimum ditch length and tolerance ⍺, returning 1 if any ditches found[2]   ⍝Part of data creation for LCC DSL ditches metric[3]   ⍝Data are prepped with getstreams.aml[4]   ⍝B. Compton, 3-14 Aug 2015 [5]   ⍝14-17 Aug 2015: rewrite from OLD_FINDDITCHES[6]   ⍝30 Oct 2015: modify to take parameters[7]   ⍝16 Dec 2016: return success flag[8]   [9]   [10]  [11]   ⍎(0=⎕NC'A')/'A←⍳0'[12]   minlength stol ← 2↑A,(1=⍴,A)↓50 5      ⍝Minimum length of a ditch section, tolerance for straightness (in percent maximum deviation from line)    [13]   P←'D:\LCC\ditches2\NEWTEST\' PATH STRIPPATH F[14]   X←MATIN P PATH F,'.txt'                                          ⍝Read x1,y1,x2,y2[15]   [16]   Y←stol GENERALIZELINES X[17]   Y←(minlength≤(+/(Y[;1 2]-Y[;3 4])*2)*.5)⌿Y[18]  [19]   head←1↓⎕TCHT MTOV MATRIFY 'x1 y1 x2 y2'          ⍝All done. Save results.[20]   Y TMATOUT T←P PATH F,'A.txt'[21]   ⎕←⎕TCNL,'FINDDITCHES is done; ',(⍕1↑⍴Y),' ditches found. Results written to ',T[22]  [23]   →(~Z←~0∊⍴Y)/0[24]  [25]   (T←P PATH F,'_lines.txt') GENERATELINES Y[26]   ⎕←'Use &r generatelines ',T,' ',(P PATH STRIP T),' to create a line coverage.'    ∇