    ∇ Z←A BAD_ROTATE X;R;J;I;IJ;O;B[1]   ⍝Rotate matrix ⍵ clockwise ⍺ degrees[2]   ⍝B. Compton, 21 Nov 2016 (well is back after 11 weeks, and on-demand hot water is almost in)[3]   [4]   [5]   [6]    R←2 2⍴1 ¯1 1 1×2 1 1 2○RAD A               ⍝Rotation matrix[7]    I←⍉(⍴X)⍴⍳1↓⍴X                              ⍝Build indices[8]    J←(⍴X)⍴⍳1↑⍴X[9]   ⍝ IJ←((,I),[1.5],J)-O←((×/⍴X),2)⍴⌈(⍴X)÷2     ⍝Indices (origin in center)[10]  IJ←((,I),[1.5],J)[11]   IJ←IJ+.×R[12]  IJ←⌊.5+IJ[13]  ⍝ IJ←O+⌊.5+IJ[14]  ⍝    B←,(DIST 1↑⍴X)≤⌊.5×1↑⍴X[15]  ⍝      IJ←B⌿IJ[16]  ⍝ X←0,(0⍪X⍪0),0[17]  ⍝ X←0,(0⍪X⍪0),0[18]  ⍝IJ←IJ+2 [19]  ⍝ IJ←((^/IJ≥1)^^/IJ≤((1↑⍴IJ),2)⍴⍴X)⌿IJ [20]  [21]   [22]   IJ←1+IJ-(⍴IJ)⍴⌊⌿IJ[23]   Z←((⌈⌿IJ)⍴0) SCATR IJ (,X)[24]   Z←(⍴X)↑(⌊((⍴Z)-⍴X)÷2)↓Z    ∇