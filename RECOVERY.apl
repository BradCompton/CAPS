    ∇ Z←RECOVERY E;T[1]   ⍝Wait for crashed grid servers to be recovered; return 1 if need to try again[2]   ⍝Note: must localize firstfail in calling function[3]   ⍝Call like this: →(RECOVERY err)/L3, where label is gridio function[4]   ⍝B. Compton, 13 Nov 2013[5]   ⍝19 Nov 2013: units, units, units![6]   [7]   [8]   [9]    Z←0[10]   :if E∊¯625 ¯631                            ⍝If grid server isn't responding,[11]      →(0=⎕NC 'maxrecovery')/0                   ⍝   and maxrecovery exists,[12]      →(maxrecovery=0)/0                         ⍝   and isn't 0,[13]      :if 0=⎕NC 'firstfail'                      ⍝   if this is first failure,[14]         firstfail←⎕AI[2]                        ⍝      start timer[15]         ⎕←'Grid server unavailable...waiting for recovery (',NOW,')...' ⋄ FLUSH[16]      :end[17]      →(⎕AI[2]≥firstfail+maxrecovery×60)/0       ⍝   if we've waited too long, throw error[18]      T←⎕DL 60                                   ⍝   wait 1 minute[19]      DOT[20]      Z←1[21]      →0                                         ⍝   and try again[22]   :else[23]      :if 0≠⎕NC 'firstfail'                      ⍝If there was a previous failure,[24]          ⎕←'Grid server recovered (',NOW,')' ⋄ FLUSH[25]      :end[26]   :end    ∇