    ∇ A TIDES T;E;M;P;D;I;J;Q;N;S;F;W;R;Z;tideperiod;tidedepth;tidefreq;Y;U[1]   ⍝Calculate tidal period & depth for DEM and tidal range grids ⍺[2]   ⍝⍺ = (source grids) () (result grids) ()[3]   ⍝Tidal period is percent of time innundated (based on spring tides)[4]   ⍝Tidal depth is maximum depth of innundation in meters (based on spring tides)[5]   ⍝Tidal frequency is ordinal frequency of innundation: 0 = never, 1 = flooded by[6]   ⍝   storm surges, 2 = flooded by spring tides, 3 = flooded by daily tides,[7]   ⍝   4 = exposed by spring low tides, 5 = subtidal[8]   ⍝Inputs:[9]   ⍝   DEM - 30 m DEM[10]  ⍝   meanrange - interpolated mean tidal range[11]  ⍝   spring - regression parameters to get to spring range from meanrange[12]  ⍝   surge - regression parameters to get to[13]  ⍝   mask - you'll want to use coastmask for this metric![14]  ⍝Assumes springrange = 0 for uplands, and MV where we're not running CAPS[15]  ⍝Run as a CAPS metric[16]  ⍝B. Compton, 9 Dec 08 and 15 Dec 08[17]  ⍝16 Jan 2009: Use GETINFO scheme[18]  ⍝8 Jan 2010: modifications given new data[19]  [20]  [21]  THIS IS AN OBSOLETE APPROACH.  USE settides.aml INSTEAD.[22]  [23]  [24]   READPARS ME[25]  [26]   E←READ 1⊃1⊃A                   ⍝Elevation[27]   BREAKCHECK[28]   M←READ 2⊃1⊃A                   ⍝Mean tidal range[29]   BREAKCHECK[30]   S←MVREP (spring[1]+M×spring[2]) (M=MV)   ⍝Spring tidal range[31]   U←MVREP (surge[1]+M×surge[2]) (M=MV)     ⍝Mean annual surge height[32]   BREAKCHECK[33]   →(0∊⍴mask)/L0                  ⍝If mask grid supplied,[34]   Y←0 MVREP READ mask            ⍝   read it[35]   →(~1∊Y)/0                      ⍝   if block is all masked, get out now[36]   →L01[37]  L0:LOG '*** Warning in TIDES: no mask grid supplied--this will take longer than you might want!'[38]  L01:P←D←F←(⍴M)⍴0                ⍝Results: period and depth[39]   →(^/E∊MV,0)/L9                 ⍝If some input data,[40]   W←.5×1○(○2)×(⍳N)÷N←100         ⍝   Build sine wave here (default = ca 12 min precision)[41]   I←0[42]  L1:→((1↑⍴E)<I←I+1)/L9           ⍝   For each row and column,[43]   BREAKCHECK[44]   J←0[45]  L2:→((1↓⍴E)<J←J+1)/L1[46]   →((Y[I;J]≠1)∨M[I;J]∊MV,0)/L2   ⍝      Skip if no data or no tides[47]   R←0⌈(M[I;J]×W)-E[I;J]          ⍝      Water scaled to mean tidal range[48]   Q←0⌈(S[I;J]×W)-E[I;J]          ⍝      Water scaled to spring tidal range[49]   P[I;J]←(+/Q>0)÷N               ⍝      Spring tidal period[50]   D[I;J]←⌈/,Q                    ⍝      Spring tidal depth[51]   F[I;J]←+/∨\(0<⌊/Q),(0<⌊/R),(∨/R>0),(∨/Q>0),U[I;J]>E[I;J]   ⍝      Tidal frequency[52]  ⍝      ⎕←P[I;J],D[I;J],F[I;J]⋄[53]   →L2[54]  [55]  L9:P←S REMV P                   ⍝Nodata cells where spring tide is nodata[56]   D←S REMV D[57]   F←S REMV F[58]   P WRITE (pathR PATH 1⊃3⊃A)     ⍝Period[59]   D WRITE (pathR PATH 2⊃3⊃A)     ⍝Depth[60]   F WRITE (pathR PATH 3⊃3⊃A)     ⍝Frequency[61]   →0[62]  [63]  what:data prep[64]  type:standard[65]  info:('dem' 'meanrange') ('') ('tideperiod' 'tidedepth' 'tidefreq') (0)    ⍝Sourcegrids, .., result grids, ..    ∇