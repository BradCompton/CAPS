    ∇ Z←B ASSEMBLE M;R;I;Q;X;N;Y;T[1]   ⍝Write lines to assemble.aml to build grid from metric ⍵ with ⍺ blocks[2]   [3]   [4]    R←(⊂FRDBL M),¨↓R←BLOCKIDS ⍳B[5]    Z←'' OVER '/* Assemble grids for ',M[6]    Z←Z OVER ''[7]    Z←Z OVER ↑(⊂'asciigrid '),¨R,¨(⊂'.zzz '),¨R,¨⊂' float'[8]    R←↑R[9]    Z←Z OVER 'grid'[10]   I←0 ⋄ Q←X←0 0⍴'' ⋄ N←45              ⍝      Do N grids at a time[11]  L1:Y←(T←'zz',((N<1↑⍴R)/⍕I)),' = merge('[12]   X←X OVER T[13]   Y←Y,1↓,',',R[(T≤1↑⍴R)/T←I+⍳N;][14]   Q←Q OVER Y,')'[15]   →((1↑⍴R)>I←I+N)/L1[16]   →(N≥1↑⍴R)/L2                      ⍝      If multiple merges,[17]   Q←Q OVER M,' = merge(',(1↓','MTOV X),')'[18]   →L3[19]  L2:Q←Q OVER M,' = zz'[20]  L3:Q←Q OVER 'q'[21]   Q←Q OVER ↑(⊂'kill '),¨↓X[22]   Z←Z OVER Q[23]   Z←Z OVER ↑(⊂'kill '),¨↓R[24]   Z←Z OVER 'del ',M,'???.zzz'[25]   Z←Z OVER 'gridascii ',M,' ',M,'.asc'       ⍝Finally, make an ascii grid[26]   Z←MTOV Z    ∇