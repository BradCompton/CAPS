    ∇ A MAKEMASK S;D50;DS;weights;X;W;water;B[1]   ⍝Make the mask grid for LCC project, masking out rivers and lakes on the data borders[2]   ⍝Create a grid "edgerivers" with 1's for areas where edge rivers can be masked[3]   ⍝B. Compton, 5-6 Mar 2014[4]   ⍝11-17 Mar 2014: clip to nonzero/nonmissing cells in 'states'[5]   [6]   [7]   [8]    READPARS ME[9]    X←READ 1⊃1⊃A                                       ⍝Read luwet[10]   X←MVREP X ((READ 3⊃1⊃A)∊0,MV)                      ⍝Clip to state boundaries[11]   W←X∊(LOOKUP 1,[1.5]FRDBL¨↓',' MATRIFY water)[;1]   ⍝Water cells[12]   W←W^1=READ 2⊃1⊃A                                   ⍝And in edgeriver zones[13]  L1:DOT[14]   B←W^(X≠MV)^FOCALMAX X=MV                           ⍝Repeat: cells to remove from mask[15]   X←MVREP X B                                        ⍝   Remove them[16]   →(∨/,B)/L1                                         ⍝Until none to remove[17]   (X≠MV) WRITE 3⊃A[18]   →0[19]  [20]  [21]  what:data prep[22]  type:standard[23]  info:('luwet' 'edgerivers' 'states') ('') (pathG,'mask') 1 '*'      ⍝Source grid, settings table, result grid, buffer size, and NO TILEMAP CALL![24]  check:CHECKVAR 'water'    ∇