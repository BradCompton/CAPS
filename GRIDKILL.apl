    ∇ E GRIDKILL G;Z;C;R;Q;err;A;B;firstfail;I;M;M_;N;P;T[1]   ⍝Kill grid(s) and mosaics ⍵.  Suppress grid not found error unless ⍺[1]; grid is guaranteed not to be a mosaic if ⍺[2][2]   ⍝Uses the appropriate server to kill each grid so we don't get burned by cached data[3]   ⍝B. Compton, 8 Jan 2009; E. Ene, 19 Feb 2009[4]   ⍝5 Nov 2013: also kill mosaics[5]   ⍝13 Nov 2013: add grid server recovery[6]   ⍝14 Nov 2013: split from primitive ∆GRIDKILL and kill each grid with the appropriate server; 21 Nov: make robust to bad mosaics[7]   ⍝21 Nov 2014: remove killed grids from gridinfo[8]   ⍝16 Aug 2016: crashed if the same grid was listed twice[9]   ⍝9 Aug 2017: was passing gridname to FINDCONNECTION wrong...it wasn't using it correctly before, so I didn't realize it[10]  [11]  [12]  [13]   ⍎(0=⎕NC'E')/'E←0'[14]   E←2↑E[15]  [16]   G←FRDBL¨↓MATRIFY G[17]   G←((G⍳G)=⍳⍴G)/G                                            ⍝Make sure grids are unique[18]   →(0∊⍴G←(IFEXISTS¨G,¨'\')/G)/0                              ⍝Skip grids that don't exist[19]  [20]   I←0[21]  L1:→((⍴G)<I←I+1)/L2                                         ⍝For each grid or mosaic,[22]   :if 0=1⊃FILEINFO (I⊃G),'\'                                 ⍝   if it's a folder without files,[23]      RDIR I⊃G                                                ⍝      delete it[24]      →L1[25]   :end[26]   :if Q←~E[2]                                                ⍝   if we're sure it's not a mosaic, suppress slow GRIDDESCRIBE call[27]      :Try[28]         Q←(GRIDDESCRIBE I⊃G)[12][29]      :catch[30]         RDIR I⊃G[31]         →L1[32]      :end[33]   :end[34]   :if Q                                                      ⍝   if it's a mosaic,[35]      :Try[36]         M M_ ← MOSAICINFO I⊃G[37]      :catch[38]         RDIR I⊃G[39]         →L1[40]      :end[41]      P←N/⍳⍴N←⎕FI((2×⍴N)⍴1 0)\N←⊃M[M_ COL 'panemap']          ⍝   panes[42]      :if ~0∊⍴Q←PANEPATH¨(⊂(G[I])),¨(⊂M[M_ COL 'name']),¨P,¨⍴N⍝   if any panes exist,[43]         0 1 GRIDKILL ⊃,/' ',¨Q                               ⍝      kill individual panes[44]      :end[45]      RDIR I⊃G                                                ⍝      finally, remove folder, description, and empty subfolders with info folders[46]   :else                                                      ⍝   else, it's a grid[47]      :if 0≠C←FINDCONNECTION (5↑GRIDDESCRIBE I⊃G) (I⊃G)       ⍝      find connection; if found,[48]         SETCONNECTION C                                      ⍝         use this connection[49]      :end[50]      SETCACHE C=0                                            ⍝      else, use local grid server because no grid server is referencing it[51]      ACTIVATECONNECTION[52]      ∆GRIDKILL I⊃G                                           ⍝      kill the grid[53]   :end[54]   →L1[55]  [56]  L2:gridinfo←(~(TOLOWER¨gridinfo[;1])∊TOLOWER¨G)⌿gridinfo    ⍝Remove killed grids from gridinfo    ∇