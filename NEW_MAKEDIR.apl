    ∇ NEW_MAKEDIR D;⎕ELX;P;T;Q[1]   ⍝Create new directory ⍵, creating parent directory if necessary[2]   ⍝B. Compton, 5 May 2011[3]   ⍝21 Nov 2013: check for collisions[4]   ⍝27 Mar 2014: do several tries in IFEXISTS before throwing an error[5]   ⍝31 Mar 2014: that didn't work. Use Ethan's approach of locking the containing directory[6]   [7]   [8]   [9]    D←(-'\'=¯1↑D)↓D←FRDBL D[10]   →(IFEXISTS D,'\')/0                        ⍝If directory already exists, exit[11]   :if ~IFEXISTS P←(-¯1+(⌽D)⍳'\')↓D           ⍝If parent directory doesn't exist,[12]      MAKEDIR P                               ⍝   Create it, recursively[13]   :end[14]  [15]   Q←LOCKFILE D,'\'                           ⍝Lock the directory[16]   :if IFEXISTS D,'\'                         ⍝If it exists now,[17]      UNLOCKFILE Q                            ⍝   Success[18]      →0[19]   :end                                       ⍝Else,[20]  [21]   :Try[22]      ⎕MKDIR D                                ⍝   Create directory[23]   :Catchif 'DOMAIN ERROR'≡(¯1+⎕DM⍳⎕TCNL)↑⎕DM ⍝   If DOMAIN ERROR[24]      UNLOCKFILE Q[25]      →(IFEXISTS D,'\')/0                     ⍝      and the directory already exists, we've had a collision--we're good now[26]      ⎕ERROR ⎕DM                              ⍝      otherwise, we've got a real error[27]   :end    ∇