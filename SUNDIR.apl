    ∇ Z←D SUNDIR hour;dayofyear;gamma;eqtime;timeoffset;tst;ha;elevation;azimuth;decl;theta;costheta;azimuth1;A;B[1]   ⍝Give azimuth & elevation of sun at times ⍵ on date ⍺[2]   ⍝Globals:[3]   ⍝   latlong     latitude & longitude[4]   ⍝   timezone    time zone (offset from UTC)[5]   ⍝e.g. 2 25 2008 SUNDIR 11.5     ⍝direction of sun at 11:30 am[6]   ⍝Time can be fractional, e.g. 16.5 = 6:30 pm[7]   ⍝Source: "General solar position calculations", NOAA, http://www.srrb.noaa.gov/highlights/sunrise/calcdetails.html[8]   ⍝This is the low-accuracy version; it's always within a fraction of a degree[9]   ⍝B. Compton, 25 Feb 2008[10]  [11]  [12]   ⍎(0=⎕NC'D')/'D←⎕TS[2 3 1]'[13]   dayofyear←''⍴DAYSINYEAR D[14]   hour←,hour[15]   latlong[2]←|latlong[2]         ⍝Don't let W longitude mess us up![16]  [17]  ⍝ timezone←5                     ⍝UTC time zone for eastern time[18]  ⍝ latlong←42.649 72.313          ⍝Latitude, longitude in degrees for Warwick, MA[19]  [20]  ⍝latlong[1]←35+5÷60⋄latlong[2]←106+39÷60⋄timezone←7  ⍝Albaquerque[21]  ⍝latlong[1]←61+13÷60⋄latlong[2]←149+54÷60⋄timezone←9 ⍝Anchorage[22]  [23]   gamma←((○2)÷365)×(dayofyear-1)+(hour-12)÷24        ⍝Fractional year[24]   eqtime←229.18×.000075+(.001868×COS gamma)+(¯.032077×SIN gamma)+(¯.014615×COS 2×gamma)+¯.040849×SIN 2×gamma     ⍝Equation of time, in minutes[25]   decl←.006918+(¯.399912×COS gamma)+(.070257×SIN gamma)+(¯.006758×COS 2×gamma)+(.000907×SIN 2×gamma)+(¯.002697×COS 3×gamma)+.00148×SIN 3×gamma     ⍝Declination[26]  [27]   timeoffset←eqtime+(¯4×latlong[2])+timezone×60            ⍝Time offset[28]   tst←(hour×60)+timeoffset[29]   ha←(tst÷4)-180                 ⍝Solar hour angle, in degrees[30]  [31]   costheta←((SIN RAD latlong[1])×SIN decl)+(COS RAD latlong[1])×(COS decl)×COS RAD ha     ⍝Cosine of solar zenith angle[32]   theta←¯2○costheta              ⍝Solar zenith angle[33]   elevation←90-DEG theta         ⍝Elevation, in degrees[34]  [35]   azimuth1←(((SIN RAD latlong[1])×COS theta)-SIN decl)÷(COS RAD latlong[1])×SIN theta      ⍝Solar azimuth (from north)[36]   azimuth←180-DEG ¯2○azimuth1[37]   A←180+180-azimuth              ⍝Afternoon azimuths[38]   azimuth[B]←A[B←(12<hour+timeoffset÷60)/⍳⍴A][39]  [40]   Z←azimuth,[1.5]elevation            ⍝Azimuth & elevation[41]  [42]  →0[43]  [44]  ⎕←'dayofyear = ',⍕dayofyear[45]  ⎕←'gamma (fractional year) = ',⍕gamma[46]  ⎕←'eqtime (equation of time) = ',⍕eqtime[47]  ⎕←'declination = ',⍕decl[48]  ⎕←'declinaion, in degrees = ',⍕DEG decl[49]  ⎕←'time offset = ',⍕timeoffset[50]  ⎕←'tst = ',⍕tst[51]  ⎕←'cos solar zenith angle = ',⍕costheta[52]  ⎕←'elevation = ',⍕elevation[53]  ⎕←'solar zenith angle = ',⍕theta[54]  ⎕←'cos(180-azimuth) = ',⍕azimuth1[55]  ⎕←'solar azimuth = ',⍕azimuth[56]  ⎕←''[57]  ⎕←'Azimuth, elevation = ',⍕Z    ∇