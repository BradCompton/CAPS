    ∇ S ∆SETWINDOW G;Q;N;err;REST;A;Z;firstfail[1]   ⍝Sets grid access window to grid ⍵; ignore window already set if ⍺[2]   ⍝Sets gridwindow to cols, rows, xll, yll, cellsize, nodata, blockonly (1 if no caching)[3]   ⍝B. Compton, 14 Jan 2009; E. Ene, 6 Feb 2009[4]   ⍝2 May 2011: set global gridwait for task manager[5]   ⍝6 Sep 2013: call ∆CLEANUP to release old buffers[6]   ⍝9 Sep 2013: set gridwindow instead of returning window[7]   ⍝10 Sep 2013: change from SETWINDOW[8]   ⍝13 Nov 2013: add grid server recovery[9]   [10]  [11]  [12]   ⍎(0=⎕NC'S')/'S←0'[13]   →(aplc=1)/L9                                   ⍝If C version,[14]   →(3=⎕NC'SETWINDOWc')/L1                        ⍝   If not loaded,[15]   Q←⎕EX 'SETWINDOWc'[16]   ⎕ERROR REPORTC 'DLL I4←CAPS_LIB.setwindow(*C1,*I4←,*I4←,*F8←,*F8←,*F8←,*I4←)' ⎕NA 'SETWINDOWc'[17]  ⍝⎕←'CAPS_LIB.setwindow loaded.'[18]  [19]  L1:A←⎕AI[2][20]  L3:err←1↑Z←SETWINDOWc (G,⎕TCNUL) 1 2 3 4 5 6[21]   →(RECOVERY err)/L3                             ⍝Wait for crashed grid servers to recover[22]   GRIDWAIT A[23]   ⎕ERROR REPORTC (1+err≠S×¯10014)⊃1 err          ⍝If ⍺, ignore window already set error[24]   Z←Z[3 2 5 4 6],MV,Z[7][25]   gridwindow←Z[26]   →0[27]  [28]  L9:(PATH G,'.asc') ⎕XNTIE N←-1+0⌈⌈/|⎕XNNUMS     ⍝APL version[29]   Z←DEB 1 NGET N,1000                            ⍝Read block[30]   ⎕NUNTIE N[31]   Z←((+\Z=⎕TCNL)⍳6)↑Z                            ⍝Get header[32]   G←FIRSTCOL Z[33]   Z←⎕FI,' ',VTOM FIXE REST                       ⍝Header values[34]   gridwindow←Z    ∇