    ∇ Z←D DOWNSTREAM G;F;I;J;Q;K[1]   ⍝AQCONNECT subroutine: if downstream option (⍺) is true, give only cells in 1⊃⍵ upstream of 3 4⊃⍵ in flow grid 2⊃⍵[2]   ⍝Selects upstream cells, thus giving downstream connectivity from each point[3]   ⍝For Yoichiro[4]   ⍝B. Compton, 20 Jun 2013[5]   [6]   [7]   [8]    ⍎(0=⎕NC'D')/'D←1'      ⍝Default: do it[9]    Z←1⊃G[10]   →(~D)/0[11]   G F I J ← G[12]   Q←I J⍪F FLOWINTO I J   ⍝Cells upstream of focal cell[13]   K←1[14]  L1:→((K←K+1)>1↑⍴Q)/L2   ⍝While there are still cells to look at[15]   Q←Q⍪F FLOWINTO Q[K;]   ⍝   Keep looking upstream[16]   →L1[17]  [18]  L2:Z←((⍴Z)⍴0) SCATR Q (Z SCATI Q)    ∇