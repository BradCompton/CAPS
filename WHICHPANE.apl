    ∇ Z←W WHICHPANE X;Q[1]   ⍝Return pane number for each x,y coordinate in matrix ⍵ for mosaic ⍺[2]   ⍝   ⍺[1]    mosaic window (cols, rows, xll, yll cellsize)[3]   ⍝   ⍺[2]    number of cell rows and cols in pane[4]   ⍝   ⍺[3]    if 1, return all panes inclusively among points ⍵ (default = 0)[5]   ⍝           Note: inclusive panes are greedy, and may include extra panes[6]   ⍝           for lines[7]   ⍝B. Compton, 24-29 Oct 2013[8]   [9]   [10]  [11]   Z←W[1] POINT2CELL¨↓X                       ⍝Convert points to cells[12]   Z←(⊂(1⊃W)[2 1])⌊1⌈Z                        ⍝Can't go beyond panes[13]   Z←⌈↑Z÷W[2]                                 ⍝Figure out which pane rows and columns we're in[14]   :if (3↑W,0)[3]                             ⍝If all panes,[15]      Z←↑,(1⊃Z)∘.,2⊃Z←(⌊⌿Z)+0,¨⍳¨(⌈⌿Z)-⌊⌿Z    ⍝   Get all panes, inclusively[16]   :end[17]   Q←⌈(1⊃W)[2 1]÷2⊃W                          ⍝Number of rows and cols in landscape[18]   Z←(Q⍴⍳×/Q) SCATI Z                         ⍝Convert to pane number (row-major order)    ∇