    ∇ Z←TRr1 I;Q;R;L[1]   ⍝Recursive subroutine of TRx_DSL for cell ⍵[2]   ⍝Walk up from outflow, then back down, summing salt marsh cells and potential salt marsh cells above each crossing[3]   ⍝Globals: d8flow sm psm cross tr[4]   ⍝B. Compton, 2-6 Sep 2016[5]   ⍝12 Oct 2016: bail on edges[6]   [7]   [8]    [9]    Z←⍳0[10]   L←↓d8flow FLOWINTO I                   ⍝cells that flow into this one[11]   →((∨/I=1)∨∨/I=⍴d8flow)/0               ⍝If we've hit an edge, results are junk, so bail out[12]   Q←TRr1¨L                               ⍝Recursive calls to inflowing cells[13]   →((⊂⍳0)∊Q)/0                           ⍝Or if recursive calls have hit an edge, also bail out[14]   Z←(⊃+/Q)+sm[I[1];I[2]],psm[I[1];I[2]]  ⍝Sum salt marshs and potential salt marshes above[15]   :if cross[I[1];I[2]]                   ⍝If at crossing, [16]      tr[I[1];I[2]]←1-Z[1]÷⌈/Z            ⍝   Get TR value (salt marsh loss ratio--not >1!)[17]   :end    ∇