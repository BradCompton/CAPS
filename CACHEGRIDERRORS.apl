    ∇ CACHEGRIDERRORS;D;D_;Z;I;head;T;U[1]   ⍝Check for existance and corruption of all source grids corresponding to grids in the local grid cache[2]   ⍝B. Compton, 4 Feb 2015[3]   [4]   ABANDONED[5]   [6]    D D_ ← 1⊃GETCACHEDIR 1[7]    ∆GRIDINIT ''[8]    Z←D[;D_ COL 'source'],((1↑⍴D),3)⍴0[9]    ⎕←'Checking ',(⍕1↑⍴Z),' grids... (. = okay, m = missing grid folder, s = missing STA file, X = corrupt grid)'[10]   ⎕←'   Missing grid folder may be because it hasn''t yet been restored; missing STA may be because it hasn''t'[11]   ⎕←'   yet been unzipped.'[12]   I←0[13]  L1:→((1↑⍴D)<I←I+1)/L2                           ⍝For each grid in cache,[14]   Z[I;2]←~IFEXISTS (⊃Z[I;1]),'\'                 ⍝   does grid folder exist?[15]   Z[I;3]←~IFEXISTS (⊃Z[I;1]),'\sta.adf'          ⍝   does sta file exist?[16]   Z[I;4]←1↑1 IFERRIN 'T←∆GRIDDESCRIBE ⊃Z[I;1]'   ⍝   can we describe it?[17]   ⍞←'.Xsm'[1+⌈/Z[I;2 3 4]×⌽⍳3],(I=⎕PW×⌊I÷⎕PW)/⎕TCNL ⋄ FLUSH[18]   →L1[19]  [20]  L2:⎕←⎕TCNL,(⍕T←+/Z[;2]),' missing grid folders'[21]   ⎕←(⍕U←(+/Z[;3])-T),' grids with missing STA files'[22]   ⎕←(⍕(+/Z[;4])-T+U),' corrupt grids'[23]  [24]   head←1↓⎕TCHT MTOV MATRIFY 'folder sta describe grid'[25]   Z[;2 3 4 1] TMATOUT T←(2⊃cache),'cachegriderrors.txt'[26]   ⎕←'Results have been written to ',T,'. 1s indicate missing/bad grids'    ∇