    ∇ Z←C FASTHULL X;J;L;Q;K;I[1]   ⍝Return least-cost hull of focal cell ⍵ given transition costs ⍺[2]   ⍝New speedy version, 21 Aug 2003[3]   [4]    K←9 2⍴¯1 ¯1 ¯1 0 ¯1 1 0 ¯1 0 0 0 1 1 ¯1 1 0 1 1[5]    X←¯2,¯2⍪((X-X=0)⍪¯2),¯2               ⍝Undone cells = ¯1, border = ¯2[6]    J←1+(1 0+⍴X)⊤¯1+(,X)⍳⌈/,X             ⍝Focal cell I,J[7]    L←0 7⍴0[8]   L1:Q←((⍴K)⍴J),X[J[1];J[2]],K+(⍴K)⍴J    ⍝   X,Y, value, neighbor X,Y[9]    Q←(¯1=,X[J[1]+¯1 0 1;J[2]+¯1 0 1])⌿Q  ⍝   Only want unvisited neighbors[10]   Q←Q,(1 1.4)[1+~∨/Q[;1 2]=Q[;4 5]]×(,C)[(Q[;5]-1)+(+Q[;4]-2)×¯1↑⍴C]  ⍝   costs[11]  [12]   Q←Q,Q[;3]-Q[;6]                       ⍝   realized values[13]   Q←(Q[;7]>0)⌿Q                         ⍝   stop when we hit zero[14]   L←L⍪Q                                 ⍝   Add cell & neighbors to list[15]   →(0∊⍴L)/L2                            ⍝   Until nothing left in list[16]   L←L[⍒L[;4 5 7];][17]   L←(∨/L[;4 5]≠0⍪¯1 0↓L[;4 5])⌿L        ⍝   Remove smallest of duplicates[18]   J←L[I←L[;7]⍳⌈/L[;7];4 5]              ⍝   Find max realized value from list[19]   X[J[1];J[2]]←L[I;7]                   ⍝   New focal cell: fill it in[20]   L←(∨/L[;4 5]≠((1↑⍴L),2)⍴J)⌿L          ⍝   and remove from list[21]   →L1[22]  L2:Z←0⌈1 1↓¯1 ¯1↓X    ∇