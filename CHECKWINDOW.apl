    ∇ Z←CHECKWINDOW W;X;R;Q;C;S[1]   ⍝Check grid server window 1⊃⍵ with set flag 2⊃⍵ against existing connections[2]   ⍝Returns (conformation flag) (message)[3]   ⍝Checks that:[4]   ⍝   1. Upper left corner matches reference window[5]   ⍝   2. Extent matches reference window, within one cell[6]   ⍝   3. Cell size is an integer multiple or factor of reference cell size[7]   ⍝B. Compton, 10-12 Sep 2013[8]   ⍝4 Oct 2013: bug fix with lower right corner[9]   ⍝2 Jan 2014: more messing with stupid high-precision extents[10]  [11]  [12]  [13]   W S ← W[14]   Z←1 ''[15]   →(S=0)/0                           ⍝Everything is okay: ∘ if window isn't set[16]   →(0=⎕NC'connections')/0            ⍝   ∘ if connections are not set[17]   →(0∊⍴connections)/0                ⍝   ∘ if connections are empty[18]   →(0∊⍴R←referencewindow)/0          ⍝   ∘ if no reference window[19]  [20]   X←W[3],W[4]+W[2]×W[5]              ⍝Upper left corner[21]   Q←R[3],R[4]+R[2]×R[5][22]   Z←0 'Upper left corner doesn''t match previous connections'[23]   →(∨/X≠Q)/0                         ⍝Upper left corner doesn't conform[24]  [25]   X←(W[3]+W[1]×W[5]),W[4]            ⍝Lower right corner[26]   Q←(R[3]+R[1]×R[5]),R[4][27]   Z←0 'Grid extent doesn''t match previous connections'[28]   →((∨/X≠Q)^∨/(0>X-Q)∨R[5]<X-Q)/0    ⍝Extent does't match[29]   →((W[4]<R[4])∨R[5]≤W[4]-R[4])/0[30]  [31]   C←(↑5↑¨(⊃,/0≠⍴¨C)/C←connections[;connections_ COL 'window'])[;5]   ⍝Existing cell sizes[32]   Z←0 'Cell size isn''t a multiple or factor of all existing cell sizes'[33]   →(~^/((W[5]<C)∨0=C|W[5])^(W[5]>C)∨0=W[5]|C)/0[34]  [35]   Z←1 ''    ∇