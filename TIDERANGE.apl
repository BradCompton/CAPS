    ∇ A TIDERANGE S;buffer;X;F;tiderange;fd;transparent;Q;C[1]   ⍝Extrapolate tide range data from VDatum upflow[2]   ⍝   1. Run makevdatumpoints.aml (split between 2 tiles) [see Tide range data for TR.docx for more up-to-date instructions][3]   ⍝   2. Run VDatum (twice)[4]   ⍝   3. Read resulting text files into ArcView and convert to 90 m grids[5]   ⍝   4. In Arc, for each grid, mlw30 = resample(mlw90, 30, bilinear)[6]   ⍝   5. Then range = mlw30 - mhw30[7]   ⍝   3. Finally, run TIDERANGE[8]   ⍝      (it may be necessary to run this a few times)[9]   ⍝Parameters:[10]  ⍝   tiderange   name of grid with tiderange. Results will be tiderange2[11]  ⍝B. Compton, 25 Nov 2015[12]  ⍝1 Dec 2015: write 0s as missing so other tiles can fill in[13]  [14]  [15]  [16]   READPARS ME[17]   buffer←4⊃A[18]   X←READ 1⊃1⊃A               ⍝Read tiderange grid[19]   F←0 MVREP READ 2⊃1⊃A       ⍝Read flow grid[20]   fd←(2*¯1+⍳8),8 2⍴0 1 1 1 1 0 1 ¯1 0 ¯1 ¯1 ¯1 ¯1 0 ¯1 1[21]  [22]  L1:Q←F DOWNFLOW X           ⍝While we can make changes, get downstream value,[23]   DOT[24]   C←(F≠0)^(X=MV)^Q≠MV        ⍝Changed cells: have flow, no tiderange, but do have a downstream value[25]   →(~∨/,C)/L2                ⍝Until we're done changing[26]   X←(X×~C)+C×Q               ⍝Replace values[27]   →L1[28]  [29]  L2:transparent←1[30]   (MVREP X (X=0)) WRITE 3⊃A[31]   →0[32]  [33]  [34]  what:data prep[35]  type:standard[36]  info:(tiderange (pathS PATH 'flow')) ('') (tiderange,'2') 500 (pathS PATH 'coastclip')      ⍝Source grid, settings table, result grid, buffer size, and include grid[37]  check:CHECKVAR 'tiderange'    ∇