    ∇ WETSPREAD2 I;J;Q;K[1]   ⍝Do resistant kernel through streamflow grid at cell ⍵[2]   ⍝Recursive subroutine of WETSPREAD; all variables except I,J are global for speed[3]   ⍝B. Compton, 12-22 Sep 2011[4]   [5]   [6]    I J ← I[7]    Q←(Q[;1]≠0)⌿Q←(F NEXTFLOW I,J)⍪F FLOWINTO I,J  ⍝Next stream cell and source stream cells[8]    Q←(0=Z SCATI Q)⌿Q                  ⍝Don't revisit already-visited cells[9]    →(0∊⍴Q)/0[10]   Z←Z SCATR Q (0⌈Z[I;J]-R SCATI Q)   ⍝Subtract resistance and spread[11]   Q←(0≠Z SCATI Q)⌿Q                  ⍝Drop cells that have run out[12]   K←0[13]  L1:→((1↑⍴Q)<K←K+1)/0                ⍝For each neighboring cell,[14]   WETSPREAD2 Q[K;]                   ⍝   recurse[15]   →L1    ∇