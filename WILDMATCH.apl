    ∇ Z←Y WILDMATCH X;Q;T;R;E;C;S;F;I;K;B[1]   ⍝Return bit vector of rows in character matrix (or nested vector) ⍺ that match string ⍵, with wildcards ? and * in ⍵[2]   ⍝Wildcard ? matches any 1 character.[3]   ⍝Wildcard * matches any 0 or more characters[4]   ⍝Case-insensitive[5]   ⍝B. Compton, 3 Jan 2014[6]   ⍝14 Jan 2014: work for multiple ??s in a row; allow nested vector for ⍺[7]   ⍝5 Feb 2014: deal properly with empty ⍺[8]   ⍝25 Feb 2014: format arguments in case they're numeric[9]   [10]  [11]  [12]   :if 2=≡Y←⍕¨Y                               ⍝If ⍺ is nested,[13]      Y←MIX Y[14]   :end[15]  [16]   →(0∊⍴Y)/⍴Z←⍳0[17]  [18]   Y←'⎕',¨(FRDBL¨↓TOLOWER Y),¨'⎕'             ⍝Prepare search and match strings[19]   X←'⎕',(FRDBL TOLOWER ⍕¨X),'⎕'[20]  [21]   K←(K≠0)/K←(B≠¯1⌽B) pSUM B←X='?'            ⍝Count of ?s in each group[22]   X←(~B^¯1⌽B)/X                              ⍝One ? per group[23]  [24]   Q←(((⍴X)↑1)∨T∨0,¯1↓T←X∊'?*')⊂X             ⍝Split on wildcards[25]   R←(~F←(Q≡¨⊂,'?')∨Q≡¨⊂,'*')/Q               ⍝Substrings to match, without wildcards[26]  [27]   C←((⍴Y),⍴R)⍴E←0[28]   I←0[29]  L1:→((⍴R)<I←I+1)/L2                         ⍝For each substring,[30]    C[;I]←E←E+((E↓¨Y)⎕SS¨R[I])⍳¨1             ⍝   Find next match - it must follow previous match![31]    →L1[32]  [33]  L2:C←C×C≤⍉(⌽⍴C)⍴⍴¨Y                         ⍝Position of each substring match[34]   Z←⊃,/(^/C≠0)^^/C>0,0 ¯1↓C                  ⍝Have a match for * if all substrings are ascending matches[35]   :if 0<⍴K                                   ⍝If any wildcards.[36]   :andif '?'∊⊃,/F/Q                          ⍝and any ? in search string,[37]      K←(⊃,/'?'=F/Q)\K                        ⍝Expand ? count to match wildcard string[38]      S←(0 1↓C)=0 ¯1↓((⍴C)⍴K,0)+C+(⍴C)⍴⊃,/⍴¨R ⍝   Next substring starts at previous' starting postition + length of each substring + number of ?s[39]      Z←Z^⊃,/^/S∨(⍴S)⍴~⊃,/'?'=F/Q             ⍝   All matches, including single character ones![40]   :end    ∇