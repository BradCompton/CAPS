    ∇ Z←F FLOWINTO D;B;I;Q[1]   ⍝Give coordinates of cells that flow into cell ⍵ given flow grid ⍺[2]   ⍝24 Jan 2011: Don't give errors for edge cells[3]   ⍝3 Jun 2011: If flow is 0, don't return index![4]   [5]   [6]   [7]    Z←0 2⍴0 ⋄ →(0∊D)/0[8]    I←↑,(D[1]+¯1 0 1)∘.,D[2]+¯1 0 1[9]    B←^/(I≥1)^I≤(⍴I)⍴⍴F       ⍝Find edges[10]   Q←(F SCATI (B⌿I))=B/2 4 8 1 0 16 128 64 32[11]   Z←(((+/Q),2)⍴D)+Q⌿B⌿9 2⍴¯1 ¯1 ¯1 0 ¯1 1 0 ¯1 0 0 0 1 1 ¯1 1 0 1 1[12]   Z←(~(↓Z)≡¨⊂D)⌿Z    ∇