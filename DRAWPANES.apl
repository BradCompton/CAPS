    ∇ C DRAWPANES G;K;M;X;I;J;N;T;H;D;oc;Q;W;P[1]   ⍝Create polygon coverage ⍵ of panes defined by ⍺[2]   ⍝   ⍺[1 2]  number of cell rows & columns in each pane[3]   ⍝   ⍺[3]    one of:[4]   ⍝             ∘ name of reference grid[5]   ⍝             ∘ window definition (cols, rows, xll, yll cellsize)[6]   ⍝             ∘ if empty or omitted, the current access window is used[7]   ⍝Example calls:[8]   ⍝   1000 DRAWPANES 'pane1000'[9]   ⍝   1000 1000 'land' DRAWPANES 'pane1000'[10]  ⍝   2000 3500 (10095 6313 33000 772620 30) DRAWPANES 'panes235'[11]  ⍝B. Compton, 25 and 29 Oct 2013, from DRAWTILES[12]  [13]  [14]  [15]   INIT[16]  [17]   C←(1↑C),(2⍴C)[2],(3↑C,2⍴⊂⍳0)[3]    ⍝Default is square pane, using current window[18]  [19]   oc ← SAVECONNECTIONS               ⍝Save existing connections so we don't mess them up[20]  [21]   SETPATHS[22]   :if 0∊⍴3⊃C                         ⍝If reference omitted, use current window,[23]      H←W←5↑GETWINDOW[24]   :elseif ' '=1↑0⍴3⊃C                ⍝Else if reference grid supplied,[25]      GRIDINIT ''[26]      H←W←5↑GRIDDESCRIBE pathG PATH 3⊃C ⍝   get window from grid[27]      MAKEWINDOW W[28]   :else                              ⍝Else, window supplied,[29]      H←W←5↑3⊃C[30]      GRIDINIT ''[31]      MAKEWINDOW W[32]   :end[33]  [34]   D←C[1] GCD C[2]                    ⍝We'll use GCD of pane rows & cols for our cellsize[35]   H[1 2 5]←(⌈H[1 2]÷D),D×H[5]        ⍝Use new cellsize[36]   Q←⌈H[2 1]÷C[1 2]÷D                 ⍝Number of our big cells in pane cols & rows[37]   X←(1E4×⍉Q[2 1]⍴⍳Q[1])+Q⍴⍳Q[2]      ⍝Make grid of square tiles[38]   X←H[2 1]↑(C[1]÷D)⌿(C[2]÷D)/X       ⍝Expand cells to match panes[39]   H[4]←H[4]-(×/H[2 5])-×/W[2 5]      ⍝Adjust y of lower left window[40]  [41]   P G ← (STRIPPATH pathP PATH G) (STRIP G)[42]  [43]   GRIDINIT ''[44]   MAKEWINDOW H[45]   X WRITEGRID P,'zztiles'[46]   RESTORECONNECTIONS oc[47]  [48]   ⎕←'Writing to ',P,G,'...' ⋄ FLUSH[49]  [50]   X←'/* arc.aml from DRAWPANES'[51]   X←X OVER 'w ',P[52]   X←X OVER '&s old ',P,G[53]   X←X OVER '&if [exists %old% -cover] &then'[54]   X←X OVER 'kill %old%'[55]   X←X OVER 'grid'[56]   X←X OVER G,' = gridpoly(zztiles)'[57]   X←X OVER 'q'[58]   X←X OVER 'kill zztiles'[59]  [60]   X←X OVER 'tables'[61]   X←X OVER 'additem ',G,'.pat tile 5 5 i'[62]   X←X OVER 'additem ',G,'.pat row 5 5 i'[63]   X←X OVER 'additem ',G,'.pat col 5 5 i'[64]   X←X OVER 'sel ',G,'.pat'[65]   X←X OVER 'calc tile = ',G,'-id'[66]   X←X OVER 'calc row = grid-code / 10000'[67]   X←X OVER 'calc col = grid-code - row * 10000'[68]   X←X OVER 'q'[69]  [70]   X←X OVER 'del arc.aml'[71]   X←X OVER 'q'[72]   X←X OVER ''[73]  [74]   X NWRITE P,'arc.aml'[75]   ARC P[76]   ⎕←'Polygon coverage of panes created in ',P,G,'.' ⋄ FLUSH    ∇