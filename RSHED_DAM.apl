    ∇ Z←F RSHED_DAM D;R;S;C;Q;Y;E;X;B[1]   ⍝Build resistant watershed and impounded grid for cell ⍵ in landcover, flow and resistance grids ⍺[2]   ⍝Global:[3]   ⍝   spread = spread value in cells[4]   ⍝Returns resistant watershed and binary impounded matrix, with 1's above dams[5]   ⍝B. Compton, 13-18 Aug 2009[6]   ⍝Renamed from RSHED, 2 Aug 2012[7]   [8]   [9]   [10]   X F R ← F[11]   Z←E←(⍴R)⍴0[12]   Z[D[1];D[2]]←spread                            ⍝Focal cell gets spread value[13]   C←1 2⍴D                                        ⍝Start list with focal cell[14]  L1:→(0∊⍴C)/L9                                   ⍝   If any cells left in list,[15]   Q←F FLOWINTO D←C[1;]                           ⍝      take focal cell and add inflowing cells to list[16]   Y←0⌈Z[D[1];D[2]]-R SCATI Q                     ⍝      Subtract resistance from spread[17]   Z←Z SCATR Q Y                                  ⍝      and save influence values[18]   E←E SCATR Q (B←E[D[1];D[2]]∨X[D[1];D[2]]∊dams) ⍝      If focal cell is a dam or impounded, inflowing cells are impounded[19]   C←(1 0↓C)⍪(Y>0)⌿Q                              ⍝      Keep cells that haven't reached zero[20]   →L1[21]  [22]  L9:Z←(Z÷spread) E                                ⍝Scale influence from 0~1    ∇