    ∇ Z←∆READGRID G;Q;err;A;H;firstfail[1]   ⍝C version of READGRID[2]   ⍝B. Compton, 15 Jan 2009; E. Ene, 7 Jan 2009[3]   ⍝2 May 2011: set global gridwait for task manager (20 May: do it right!)[4]   ⍝9 Aug 2011: if grid is too big, fall back to READBACK[5]   ⍝13 Nov 2013: add grid server recovery[6]   ⍝21 Nov 2013: check for multitiled grid and give error[7]   ⍝20 Jun 2016: round to single-precision (Full moon solstice). 28 Jun 2016: but don't round integer grids!!![8]   [9]   [10]  [11]  [12]   →(aplc=1)/L9                       ⍝If C version,[13]   →(3=⎕NC'READGRIDc')/L1             ⍝   If not loaded,[14]   Q←⎕EX 'READGRIDc'[15]   ⎕ERROR REPORTC 'DLL I4←CAPS_LIB.readgrid_dbl(*C1,F8,*F8←)' ⎕NA 'READGRIDc'[16]   ⎕ERROR REPORTC 'DLL I4←CAPS_LIB.readgrid_int(*C1,I4,*I4←)' ⎕NA 'READGRIDIc'[17]  ⍝⎕←'CAPS_LIB.readgrid_dbl and .readgrid_int loaded.'[18]  [19]  L1:⎕ERROR (MULTITILE G)/'Error: grid ',G,' is a multitiled ESRI grid - it can''t be read'[20]   H←∆GRIDDESCRIBE G[21]   A←⎕AI[2][22]   →(H[7]=2)/L2                       ⍝If integer grid,[23]   Z←H[2 1]⍴0[24]  L5:err Z←READGRIDIc (G,⎕TCNUL) MV Z[25]   →(RECOVERY err)/L5                 ⍝Wait for crashed grid servers to recover[26]   →L3[27]  [28]  L2:Z←H[2 1]⍴0.1                     ⍝Else, floating point[29]  L6:err Z←READGRIDc (G,⎕TCNUL) MV Z[30]   Z←7 ROUND Z                        ⍝Round to single precision to prevent goofy rounding errors[31]   →(RECOVERY err)/L6                 ⍝Wait for crashed grid servers to recover[32]  [33]  [34]  L3:→(err≠¯10016)/L4                 ⍝If grid too big error,[35]  L7:Z←∆READBLOCK (⊂G),1 1,H[2 1]     ⍝   use ∆READBLOCK to bypass cache and read big grid[36]   →(RECOVERY err)/L7                 ⍝Wait for crashed grid servers to recover[37]   GRIDWAIT A[38]   →0[39]  [40]  L4:GRIDWAIT A[41]   ⎕ERROR G REPORTC err[42]   →0[43]  [44]  L9:Z←FROMARC G,(~'.'∊G)/'.asc'      ⍝APL version: read from .asc grid    ∇