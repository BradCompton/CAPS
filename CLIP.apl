    ∇ Z←E CLIP X;Q;I;J;err[1]   ⍝Return indices into nonzero rectangle of ⍵; expand by ⍺ cells in each direction[2]   ⍝Runs APL version if aplc=1, or C version if aplc=2[3]   ⍝B. Compton/E. Ene, 8-12 Oct 2010[4]   ⍝12 Sep 2012: if argument is all 0, give empty result[5]   [6]   [7]   [8]    ⍎(0=⎕NC'E')/'E←0'[9]    →(aplc=1)/L6                   ⍝If C version,[10]   →(3=⎕NC'CLIPc')/L3             ⍝   If not loaded,[11]   Q←⎕EX 'CLIPc CLIP_Ic'[12]   ⎕ERROR REPORTC 'DLL I4← CAPS_LIB.clip_dbl(I4,I4,*F8,*I4←)' ⎕NA 'CLIPc'[13]   ⎕ERROR REPORTC 'DLL I4← CAPS_LIB.clip_int(I4,I4,*I4,*I4←)' ⎕NA 'CLIP_Ic'[14]  [15]  L3:Z←2⍴⊂⍳0 ⋄ →(^/,X=0)/0[16]   I J ← ⍴X[17]   Z←4⍴0[18]   →(645=⎕DR X)/L4                ⍝If matrix is integer,[19]   err Z ← CLIP_Ic I J X Z[20]   →L5[21]  [22]  L4:err Z ← CLIPc I J X Z        ⍝Else, floating point[23]  L5:⎕ERROR REPORTC err[24]   Z←Z+¯1 1 ¯1 1×E[25]   Z[1 3 2 4]←(1 1⌈Z[1 3]),(⍴X)⌊Z[2 4][26]   Z←(Z[1]+0,⍳Z[2]-Z[1]) (Z[3]+0,⍳Z[4]-Z[3])[27]   →0[28]  [29]  L6:Z←(^/Z) (^⌿Z←X=0)            ⍝Else, APL version[30]   Z←(+/¨^\¨Z),+/¨^\¨⌽¨Z[31]   Z←(Z[1 2])+⍳¨(⍴X)-+⌿2 2⍴Z[32]   Z←((⊂-⌽⍳E)+¨1⊃¨Z),¨Z,¨(⊂⍳E)+¨1⊃¨⌽¨Z[33]   Z←(Z≥1) SLASHEACH Z[34]   Z[1]←⊂((1⊃Z)≤(⍴X)[1])/1⊃Z[35]   Z[2]←⊂((2⊃Z)≤(⍴X)[2])/2⊃Z    ∇