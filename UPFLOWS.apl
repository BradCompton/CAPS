    ∇ Z←N UPFLOWS J;I;K;F[1]   ⍝Find all cells that flow to target cell ⍵, looking ⍺ cells upflow[2]   ⍝Global flow grid, flow, must be padded with zeros all around[3]   ⍝B. Compton, 22 Jun 2010, from FLOW2PATCH[4]   [5]   UNFINISHED, BECAUSE I REALIZED THIS WASN'T WHAT I WANTED FOR STREAMFLOW.  ALMOST WORKS[6]   [7]   [8]   ⍝Z←1 2⍴J[9]   ⍝ Z←2⍴⊂(1 2⍴J)[10]  Z←1 2⍴J[11]  ⎕←N[12]   →(N≤0)/0                   ⍝Has counter run out?[13]  ⍝Z←0 2⍴0[14]   ⍝Z[1]←⊂0 2⍴0[15]   I←(¯1+⍳3)∘.+J[16]   I←(~∨/(I≤1)∨I≥(⍴I)⍴⍴flow)⌿I    ⍝but not cells off edge[17]   F←(⊂flow) FLOWINTO¨↓I[18]   →(0∊⍴F)/0[19]   F←⊃⍪/F[20]   K←0[21]  L1:→((1↑⍴F)<K←K+1)/0        ⍝For each cell that flows into this one,[22]   Z←Z⍪⊃⍪/(N-1) UPFLOWS J+F[K;]  ⍝   Recurse[23]   →L1    ∇