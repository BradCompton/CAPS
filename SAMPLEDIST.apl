    ∇ SAMPLEDIST;N;X;L;I;Z;S;B;C;Q;Y;head;T;scales;ss[1]   ⍝Sample 1000 points in each cover type and write ⍵ points/cover type[2]   ⍝Sets up data for plot.dist() in R to help assess ecological distances among communities[3]   ⍝Inputs:[4]   ⍝   model\[5]   ⍝      landcover.par    list of all cover types[6]   ⍝      settings.par     list of settings grids[7]   ⍝   grids\[8]   ⍝      land             landcover grid[9]   ⍝   grids\settings\[10]  ⍝      settings grids   grids named in settings.par[11]  ⍝[12]  ⍝Results:[13]  ⍝   tables\[14]  ⍝      samples.txt      sampled settings values.  Column for cover type, and for each settings grid[15]  ⍝[16]  ⍝Note: This version reads the entire landscape into memory.  This works for Massachusetts, but won't[17]  ⍝for huge landscapes, so I may need to write a block version (similar to BENCH) eventually.[18]  ⍝Takes about 4 minutes on Glyptemys.[19]  ⍝B. Compton, 17 Dec 2010[20]  ⍝19 Dec 2011: Rescale settings on the fly[21]  [22]  [23]  [24]   N←100                                  ⍝Number of points to sample in each community[25]  [26]   SETPATHS[27]   INIT[28]   ⎕←'Reading landcover and selecting points...' ⋄ FLUSH[29]   L←¯1 TABLE landcoverpar                 ⍝Read landcover table[30]   S←¯1 TABLE 'settings'                  ⍝and settings table[31]   X←READBLOCK (⊂1 GRIDNAME 'land'),1 1,WINDOW[2 1]   ⍝Read landcover grid[32]   ss←MATIN pathT PATH 'scalesettings.txt'            ⍝Get original settings variable scales[33]   ss←ss[(TOLOWER MIX ss[;1]) MATIOTA TOLOWER MIX S[;1];] ⍝Reorder settings scales to match our settings variables[34]  [35]   Z←0 3⍴0[36]  [37]   BREAKCHECK[38]   I←0[39]  L1:→((1↑⍴L)<I←I+1)/L2                   ⍝For each landcover type,[40]   B←X=L[I;1]                             ⍝   Pick 1000 (or as many as possible) random cells[41]   Q←(,B)/⍳×/⍴X[42]   C←(×/⍴B)⍴0[43]   C[Q[(N⌊⍴Q)?⍴Q]]←1[44]   Z←Z⍪L[I;1],INDICES (⍴X)⍴C              ⍝   Keep cover type code & indices into grid[45]   →L1[46]  [47]  L2:Z←Z,((1↑⍴Z),1↑⍴S)⍴0                  ⍝Add enough columns for all settings variables[48]   ⍞←'Reading settings grids: ' ⋄ FLUSH[49]   I←0[50]  L3:→((1↑⍴S)<I←I+1)/L4                   ⍝For each settings grid,[51]   BREAKCHECK[52]   Y←READBLOCK (⊂pathN PATH ⍞←⊃S[I;1]),1 1,WINDOW[2 1]   ⍝   read settings grid[53]   ⍞←' ' ⋄ FLUSH[54]   Y←Y SCATI Z[;2 3][55]   Y←MVREP ((Y-ss[I;2])÷-/ss[I;3 2]) (Y=MV)[56]   Z[;I+3]←Y[57]   →L3[58]  L4:⎕←'' ⋄ FLUSH[59]   head←1↓⎕TCHT MTOV 'landcover' OVER MIX S[;1][60]   (Z[;1],0 3↓Z) TMATOUT T←pathT PATH 'samples.txt'[61]   ⎕←'Results written to ',T    ∇