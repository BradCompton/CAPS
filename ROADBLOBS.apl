    ∇ A ROADBLOBS S;X;Q;Y;R;S;I;size;U;Z;B;buffer;rate;N;pertile;M;V[1]   ⍝Create stripey blobs along roads to delineate contingent units for Critical Linkages II analysis[2]   ⍝Source:[3]   ⍝   source\roadtraffic    Raw road traffic rate grid[4]   ⍝   source\roadlines.txt  Road linework (for finding intersections)[5]   ⍝Parameters:[6]   ⍝   size                  Approximate length of each unit (m)[7]   ⍝   rate                  Minimum traffic rate to include[8]   ⍝   pertile = 2000        Maximum number of units per tile (to avoid collisions)[9]   ⍝Result:[10]  ⍝   source\roadunits      Grid with road units[11]  ⍝[12]  ⍝Note: because of tiling, there will be smaller blobs at tile edges.  Who cares.[13]  ⍝*** After running, make sure you haven't blown out pertile![14]  ⍝B. Compton, 24-25 Jan 2013[15]  ⍝11 Feb 2013: new path scheme[16]  ⍝18 Mar 2013: drop any blobs that fall at road intersections[17]  ⍝22 Nov 2013: don't use LOAD[18]  ⍝9 Oct 2014: use READVEC to get vector roads; guts pushed into subroutine to share with READPREP[19]  [20]  [21]  [22]   READPARS ME[23]   buffer←B←4⊃A[24]  [25]   X←READ 1⊃A[26]   →(0∊⍴Y←S INCLUDE X)/0                          ⍝Which cells to run for?[27]  [28]   V←READVEC pathS PATH 'roadlines.txt'           ⍝Get vector roads[29]   X←X≥rate                                       ⍝Focus on roads ≥ minimum traffic rate[30]   Z←V MAKEBLOBS X[31]   (MVREP Z (Z=0)) WRITEI 3⊃A[32]   →0[33]  [34]  [35]  [36]  what:data prep[37]  type:standard[38]  info:(pathS,'roadtraffic') ('') (pathS,'roadunits') (0) 'luwet'      ⍝Source grid, settings table, result grid, buffer size, and include grid[39]  check:CHECKVAR 'size rate pertile'    ∇