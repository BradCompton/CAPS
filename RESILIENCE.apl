    ∇ A RESILIENCE S;buffer;loop;test;noread;grids;ffile;tilesize;tilemapinclude;skiptilemap;E;Z;N;result;land;diversity;traversability;targets;D;V;X[1]   ⍝Create our version of TNC's resilience[2]   ⍝Development and excluded get zero[3]   ⍝Parameters:[4]   ⍝   land                landcover for timestep[5]   ⍝   diversity           TNC's z-scored landscape diversity grid[6]   ⍝   traversability      our traversability grid[7]   ⍝   result              raw resilience[8]   ⍝   tilesize            size of tiles (in cells)[9]   ⍝   targets = '1:1'     needs to be in parameters.par to run a single thread[10]  ⍝Runs as a CAPS metric, but only uses one thread.  It'll be fastest if you set host = 'w00'.[11]  ⍝B. Compton, 19 Jun 2017 (from ZSCORE)[12]  ⍝21 Jun 2017: if any inputs are missing, result is missing--remember that TNC's data don't always align with ours (Summer solstice)[13]  [14]  [15]  [16]   READPARS ME[17]   buffer←4⊃A[18]   loop←test←noread←0 ⋄ grids←0 0⍴''   ⍝Silly junk for BLOCK, etc.[19]   ffile←'RESILIENCE '[20]   BLOCK (2⍴tilesize),buffer[21]   SETTILE[22]  [23]   tilemapinclude←0[24]   skiptilemap←0              ⍝Don't let DEBUG sabotage this[25]   E←TILEMAP '' tilesize 0 0  ⍝Get tilemap, building it if necessary. This will only help if there's mask grid.[26]  [27]  [28]   ⎕←'Running RESILIENCE on ',(⍕+/E),' tiles' ⋄ FLUSH[29]        [30]   N←0[31]  L1:→(~E[N←N+1])/L2          ⍝Repeat: read tile (1st time through tiles), skip if not in tilemap    --- For each tile ---[32]   BREAKCHECK [33]   DOT   [34]   X←READ land                ⍝   Read land grid, (don't let GRIDNAME change this using inputs.par!)[35]   D←READ diversity           ⍝   diversity,[36]   V←READ traversability      ⍝   and traversability[37]      [38]   Z←(D+V)÷2                  ⍝   resilience[39]   Z←Z×~X∊LOOK 'developed'    ⍝   set developed to zero[40]   Z←MVREP Z ((X=MV)∨(D=MV)∨V=MV)[41]   Z WRITE 3⊃A[42]   [43]  L2: →(0≠NEXTBLOCK)/L1       ⍝Until no more tiles[44]   [45]   ⎕←''[46]   LOG 'RESILIENCE is done.'[47]   →0[48]  [49]  [50]  [51]  what:auxiliary[52]  type:table[53]  info:('') ('') (result) 0 ''      ⍝Source grid, settings table, result grid, buffer size, and include grid[54]  check:CHECKVAR 'land diversity traversability result tilesize targets'    ∇