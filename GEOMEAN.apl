    ∇ Z←W GEOMEAN X;M;N[1]   ⍝Give geometric mean across matrices in ⍵, weighted by ⍺[2]   ⍝If ⍵ isn't nested, give GEOMEAN/,⍵[3]   ⍝Rewritten 24 Aug 2007: Allow non-integer weights, cleaner[4]   [5]   [6]    ⍎(0=⎕NC'W')/'W←1'[7]    ⎕ERROR (¯1∊⊃,/×M←1 MVREP¨,X←,X)/'DOMAIN ERROR (Geometric mean of values <0)'[8]    →(1<≡X)/L1                   ⍝If just a vector or matrix, give weighted geometric mean of all values[9]    Z←0 ⋄ →(0∊M)/0               ⍝   If any zeros, result is zero[10]   Z←*(+/W×⍟M)÷+/(⍴M)⍴W[11]   →0[12]  [13]  L1:Z←X REMV (~⊃∨/N)×⊃*(+/W×⍟M+N←M=0)÷+/(⍴M)⍴W    ⍝Else, give weighted geometric mean across matrices    ∇