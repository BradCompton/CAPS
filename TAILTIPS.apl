    ∇ TAILTIPS;C;P;S;E;X;M;G;D;I;Z;T;head[1]   ⍝Create sampling points for 2008 Ambystoma maculatum genetic sampling[2]   ⍝B. Compton, 27-30 Jun 2008[3]   [4]   [5]    S←500  ⍝Number of starting points[6]    M←2000 ⍝Minimum distance between points (chosen pools may be closer)[7]    G←50   ⍝Number of points we want[8]   [9]    C←MATIN 'D:\more\tailtips\cvp.txt'[10]   P←MATIN 'D:\more\tailtips\pvp.txt'[11]  [12]   E←(⌊⌿C⍪P),⌈⌿C⍪P                    ⍝Edges[13]   E←E[1 3 2 4][14]  [15]  L0:X←(E[1]+(UNIFORM S)×(E[2]-E[1])),[1.5]E[3]+(UNIFORM S)×(E[4]-E[3])     ⍝Random points[16]  [17]   D←(((X[;1]∘.-X[;1])*2)+(X[;2]∘.-X[;2])*2)*.5[18]   D←((⍳1↑⍴X)∘.<⍳1↑⍴X)×D<M            ⍝Points within ⍺[1] m of others[19]   X←(~∨⌿D)⌿X                         ⍝Drop subsequent points that are too close[20]  [21]   ⎕←(⍕1↑⍴X),' points at least ',(⍕M),' m apart.'[22]   →(G>1↑⍴X)/L0[23]   X←(G,2)↑X[24]   ⎕←'Now have ',(⍕1↑⍴X),' points.'[25]  [26]   Z←(G,2)⍴0[27]   I←0[28]  L1:→((1↑⍴X)<I←I+1)/L2               ⍝For each point,[29]   D←(((X[I;1]∘.-C[;1])*2)+(X[I;2]∘.-C[;2])*2)*.5     ⍝   distance to each CVP[30]   →((M÷1)<⌊/D)/L3       ⍝If there's a CVP close enough,[31]   Z[I;]←((D=⌊/,D)⌿C)[1;]  ⍝Take closest CVP (first one if there are ties)[32]   →L1[33]  L3:D←(((X[I;1]∘.-P[;1])*2)+(X[I;2]∘.-P[;2])*2)*.5     ⍝   distance to each PVP[34]   Z[I;]←((D=⌊/,D)⌿P)[1;]  ⍝Take closest PVP (first one if there are ties)[35]   →L1[36]  [37]  L2:→(∨/(⍳1↑⍴Z)≠(↓Z)⍳↓Z)/L0      ⍝If duplicate pools, try again[38]  [39]   head←'x-coord',⎕TCHT,'y-coord'[40]   X TMATOUT T←'d:\more\tailtips\targets.txt'[41]   head←'pool',⎕TCHT,'x-coord',⎕TCHT,'y-coord'[42]   ((⍳1↑⍴Z),Z) TMATOUT T←'d:\more\tailtips\pools.txt'[43]   ⎕←'Results written to ',T    ∇