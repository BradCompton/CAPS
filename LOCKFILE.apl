    ∇ Z←LOCKFILE X;E;T[1]   ⍝Get a lock on ⍵ and return data for UNLOCKFILE, but only if running on cluster[2]   ⍝Returns (lock name) (⎕ELX)[3]   ⍝Just a simplified cover for GETLOCK; deals with ⎕ELX[4]   ⍝WARNING: if nesting locks, errors when debugging can leave you without 1st lock!![5]   ⍝B. Compton, 31 Dec 2013[6]   ⍝9 Jan 2014: reasonable ⎕ELX if not doing a cluster run[7]   ⍝31 May 2016: do errors right for nested locks[8]   [9]   [10]  [11]   Z←(⍳0) ⎕ELX[12]   →(0=⎕NC'cluster')/0[13]   →(~cluster)/0[14]   T←X GETLOCK 0[15]   :if 1∊(E←⎕ELX) ⎕SS '⎕ELX'                  ⍝If nested locks,[16]      ⎕ELX←'RETURNLOCK ''',X,''' ⋄ ',E[17]   :else                                      ⍝Else,[18]      ⎕ELX←'RETURNLOCK ''',X,''' ⋄ ⎕ELX←''',E,''' ⋄ ',E[19]   :end[20]   Z ← X E                                    ⍝Return lock name and original ⎕ELX    ∇