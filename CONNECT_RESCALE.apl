    ∇ Z←H CONNECT_RESCALE X;template;kernel;bench;J;I;Q;S;err[1]   ⍝Return scaled kernel volume for connectedness given bandwidth and S ⍺ and kernel, benchmark and template ⍵[2]   ⍝Runs APL version if aplc=1, or C version if aplc=2[3]   ⍝B. Compton/E. Ene, 19 Dec 2008[4]   ⍝19 Nov 2010: This new version doesn't sum results.  The original has been changed to CONNECT_RESCALE_SUM.[5]   [6]   [7]    kernel bench template ← X × 1  ⍝Enforce copies of variables so we don't muddy passed variables[8]    H S ← H[9]    →(aplc=1)/L2                   ⍝If C version,[10]   →(3=⎕NC'CONNECT_RESCALEc')/L1  ⍝   If not loaded,[11]   Q←⎕EX 'CONNECT_RESCALEc'[12]   ⎕ERROR REPORTC 'DLL I4← CAPS_LIB.connect_rescale_matrix(F8,F8,I4,I4,F8,*F8,*F8,*I4,*F8←)' ⎕NA 'CONNECT_RESCALEc'[13]  ⍝⎕←'CAPS_LIB.connect_rescale_matrix loaded (return code = ',(⍕Q),')'[14]  [15]  L1:I J ← ⍴kernel[16]   Z←(⍴kernel)⍴1.1[17]   err Z←CONNECT_RESCALEc H S I J MV kernel bench template Z[18]   ⎕ERROR REPORTC err[19]   →0[20]  [21]  L2:Z←((template≠MV)×(kernel≠0)×ZDENSITY 0⌈S-kernel÷H)÷+/,bench×MV≠template   ⍝Else, APL version    ∇