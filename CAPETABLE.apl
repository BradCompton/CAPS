    ∇ A CAPETABLE S;B;E;Z;I;X;buffer;Y;Q;J;K;L;D;T;M;C;U;R;V;P;W[1]   ⍝Do cape table thing for Scott, temporary[2]   ⍝Takes means (and n) for each community/metric in region and overall[3]   ⍝B. Compton, 18 Oct 2010[4]   [5]   [6]   [7]    buffer←B←4⊃A[8]    X←READ 1⊃A[9]    →(0∊⍴Y←S INCLUDE X)/0                      ⍝Which cells to run for?[10]   R←READ 'D:\CAPS\MORE\CAPETABLE\REGION'[11]   M←MIX,MATIN 'D:\CAPS\MORE\CAPETABLE\METRICS.TXT'[12]   C←TABLE 'D:\CAPS\MORE\CAPETABLE\COMMUNITIES.TXT'[13]   U←MIX ((C[;2]⍳C[;2])=⍳1↑⍴C)/C[;2][14]   C←C,(FRDBL¨↓U)⍳C[;2][15]   X←(C[;3],0)[C[;1]⍳X]                       ⍝X is now index into U, or 0[16]   Y←(D←,X≠0)/,X[17]   Y←Y[P←⍋Y][18]   E←Y≠0,¯1↓Y[19]  [20]   R←D/,R[21]   Z←(((1↑⍴M),1↑⍴U),2,2)⍴0    ⍝Metric × community × region × mean/n[22]   ⍎(0≠⎕NC'ct')/'Z←ct'[23]   I←0[24]  L1:→((1↑⍴M)<I←I+1)/L3       ⍝For each metric,[25]   V←READ 'D:\CAPSMA\DVD\results\scaled\',⎕←M[I;][26]   V←D/,V[27]  [28]   J←0[29]  L2:→(2<J←J+1)/L1            ⍝   First everywhere, then region[30]   ⍎(J=2)/'V←(V×R=1)+MV×R=0'             ⍝      If just in region, just in region[31]   W←V[P][32]   Z[I;E/Y;J;1]←Z[I;E/Y;J;1]+E pSUM W×W≠MV[33]   Z[I;E/Y;J;2]←Z[I;E/Y;J;2]+E pSUM W≠MV[34]   →L2[35]  [36]  L3:ct←Z[37]  [38]   Z←'--- Massachusetts ---'[39]   Z←Z OVER 'Means:'[40]   Z←Z OVER ⍕(' '⍪M),(FRDBL¨↓U)⍪ROUND ct[;;1;1] DIV ct[;;1;2][41]   Z←Z⍪' '[42]   Z←Z OVER 'Sample sizes:'[43]   Z←Z OVER ⍕(' '⍪M),(FRDBL¨↓U)⍪ct[;;1;2][44]   Z NWRITE 'D:\CAPS\MORE\CAPETABLE\cape.txt'[45]  [46]   Z←Z OVER '--- Cape region only ---'[47]   Z←Z OVER 'Means:'[48]   Z←Z OVER ⍕(' '⍪M),(FRDBL¨↓U)⍪ROUND ct[;;2;1] DIV ct[;;2;2][49]   Z←Z⍪' '[50]   Z←Z OVER 'Sample sizes:'[51]   Z←Z OVER ⍕(' '⍪M),(FRDBL¨↓U)⍪ct[;;2;2][52]   Z NWRITE 'D:\CAPS\MORE\CAPETABLE\cape.txt'[53]  [54]   →0[55]  [56]  what:junk[57]  init:⎕EX 'ct'[58]  type:standard[59]  info:('D:\CAPSMA\DVD\landcover\landcover') ('') ('') (0) 'include'      ⍝Source grid, settings table, result grid, buffer size, and include grid[60]      ∇