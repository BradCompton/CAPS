    ∇ Z←P CROSSPOINT_TEMP S;I;L;B1;B2;A1;A2;XI;YI[1]   ⍝Return x,y of crossing point(s) in any line segment in ⍵ crossed by line segment ⍺[2]   ⍝Also passes columns 5-1↓⍴⍵ for crossed segments[3]   ⍝Source: http://www.geog.ubc.ca/courses/klink/gis.notes/ncgia/u32.html#SEC32.3.4[4]   ⍝B. Compton, 18 Mar 2010, from CROSS[5]   ⍝17 Feb 2010: deal with orthogonal lines[6]   ⍝5 Aug 2010: return extra columns in S[7]   [8]   [9]    [10]   L[1;]←L[1;]+1E¯2×=⌿L            ⍝Knock lines out of perfect horizontal/vertical to avoid ÷0[11]   P[1;]←P[1;]+1E¯2×=⌿P[12]   B1←(-/P[2 1;2])÷-/P[2 1;1][13]   B2←(-/L[2 1;2])÷-/L[2 1;1][14]   A1←P[1;2]-B1×P[1;1][15]   A2←L[1;2]-B2×L[1;1][16]   XI←-(A1-A2)÷B1-B2+.0001×B1=B2   ⍝Add tiny number if lines are parallel[17]   YI←A1+B1×XI[18]   ((((P[1;1]-XI)×XI-P[2;1])≥0)^(((L[1;1]-XI)×(XI-L[2;1]))≥0)^(((P[1;2]-YI)×YI-P[2;2])≥0)^((L[1;2]-YI)×YI-L[2;2])≥0)⌿XI,YI    ∇