    ∇ Z←X SCATR IA;I;A;Q;R;C;J;err[1]   ⍝Do scattered indexed replacement. ⍺[ (1⊃⍵)[;1] ; (1⊃⍵)[;2] ] ← 2⊃⍵[2]   ⍝Runs APL version if aplc=1, or C version if aplc=2[3]   ⍝B. Compton/E. Ene, 8 Oct 2010[4]   [5]   [6]    I A ← IA[7]    Z←X ⋄ →(0∊⍴I)/0[8]    →(2=⍴⍴X)/L1                    ⍝Check inputs only if necessary[9]    X←(2↑(⍴X),1 1)⍴X               ⍝Inputs must be matrices[10]  L1:→((2=⍴⍴I)^2=¯1↑⍴I)/L2[11]   I←(¯2↑1 1,⍴I)⍴I[12]   I←((1↑⍴I),2)↑I,1[13]  L2:→(aplc=1)/L6                 ⍝If C version,[14]   →(3=⎕NC'SCATRc')/L3            ⍝   If not loaded,[15]   Q←⎕EX 'SCATRc SCATR_Ic'[16]   ⎕ERROR REPORTC 'DLL I4← CAPS_LIB.sparseput_dbl(I4,I4,I4,*F8←,*I4,*F8)' ⎕NA 'SCATRc'[17]   ⎕ERROR REPORTC 'DLL I4← CAPS_LIB.sparseput_int(I4,I4,I4,*I4←,*I4,*I4)' ⎕NA 'SCATR_Ic'[18]  [19]  [20]  L3:R C ← ⍴X[21]   Z←X[22]   A←(J←1↑⍴I)⍴A                   ⍝Cycle elements of A[23]   →(645∊⎕DR¨X A)/L4              ⍝If matrix is integer,[24]   err Z←SCATR_Ic R C J Z I A[25]   →L5[26]  [27]  L4:err Z←SCATRc R C J Z I A     ⍝Else, floating point[28]  [29]  L5:⎕ERROR REPORTC err[30]   →0[31]  [32]  L6:Z←,X                         ⍝Else, APL version[33]   Z[I[;2]+(I[;1]-1)×¯1↑⍴X]←A[34]   Z←(⍴X)⍴Z    ∇