    ∇ A QUANTILESCALE S;source;strata;result;nodata;reverse;integerize;zeropush;retainzeros;includemissing;samples;quantiles;tilesize;targets[1]   ⍝Rescale source grid by quantiles, stratified by stratify grid[2]   ⍝Parameters:[3]   ⍝   source          name of target grid[4]   ⍝   strata          name of stratification grid(s) (must be positive integers)[5]   ⍝   result          name of result grid[6]   ⍝   nodata          vector of values in strata grids to treat as missing[7]   ⍝   reverse         if yes, take complement of result[8]   ⍝   integerize      if yes, results are integers from 0 to 100 instead of floating point 0-1[9]   ⍝   zeropush        if yes, use zero-pushed quantiles (zeros are excluded from quantiles, then reincluded as 0)[10]  ⍝   retainzeros     if yes, zeros are included in quantiles, but all cells corresponding to 0 input are set to 0[11]  ⍝   includemissing  if 1, nodata cells in target grid where mask and/or stratification grids are nonmissing are treated as zeros[12]  ⍝   samples         number of samples per strata × quantile (1E4 is fairly stable)[13]  ⍝   quantiles       number of quantiles (100 for percentiles)[14]  ⍝   tilesize        size of tiles (in cells)[15]  ⍝   targets = '1:1' needs to be in parameters.par to run a single thread[16]  ⍝Runs as a CAPS metric, but only uses one thread.[17]  ⍝B. Compton, 26 Sep 2014 (from QUANTILESCALE, guts moved into QUANTILESCALESUB)[18]  [19]  [20]  [21]   READPARS ME[22]   QUANTILESCALESUB A[23]   LOG 'QUANTILESCALE is done.'[24]   →0[25]  [26]  [27]  what:auxiliary[28]  type:table[29]  info:((⊂source),FRDBL¨↓MATRIFY strata) ('') (result) 0 ''      ⍝Source grid, settings table, result grid, buffer size, and include grid[30]  check:CHECKVAR 'source strata result nodata reverse integerize zeropush retainzeros includemissing samples quantiles tilesize targets'    ∇