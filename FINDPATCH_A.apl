    ∇ ZZ←FINDPATCH_A XX;I;J[1]   ⍝Id all patches in ⍵[2]   ⍝Uses global KK (adjacent cells for 4- or 8-neighbor rule)[3]   ⍝Ignores zero-valued cells[4]   [5]    ZZ←(XX≠0)×(⍴XX)⍴¯1[6]    I←0[7]   L1:I←I+1                          ⍝Patch id[8]    J←1+(1 0+⍴XX)⊤¯1+(,ZZ)⍳¯1        ⍝   Next new patch[9]    →(J[1]>1↑⍴XX)/0                  ⍝   All done?[10]   (I,XX[J[1];J[2]]) FILLPATCH J[11]   →L1    ∇