    ∇ Z←F POINTSHED X;fd;Y;Q;K;L[1]   ⍝Build a watershed for cell I,J ⍵, given D8 flow grid ⍺[2]   ⍝This version is 64× faster than original POINTSHED1[3]   ⍝B. Compton, 22 Dec 2014[4]   [5]   [6]   [7]    F←0,(0⍪F⍪0),0                          ⍝Add a border[8]    X←X+1[9]   [10]   K←(,⍉K),[1.5],K←3 3⍴⍳3[11]   L←3 3⍴2 4 8 1 ¯1 16 128 64 32[12]  [13]   X←1 2⍴X[14]   Z←(⍴F)⍴0[15]  [16]  L1:Z[X[1;1];X[1;2]]←1                   ⍝Outflow of watershed[17]   Q←F[X[1;1]+¯1 0 1;X[1;2]+¯1 0 1]=L     ⍝Neighbors flowing into this cell[18]   X←(1 0↓X)⍪(((+/,Q),2)⍴¯2+X[1;])+(,Q)⌿K[19]   →(~0∊⍴X)/L1[20]  [21]   Z←1 1↓¯1 ¯1↓Z    ∇