    ∇ Z←F NEXTFLOW I[1]   ⍝Give I,J of cells that cells I,J ⍵ flow into following flow grid ⍺, using directions fd[2]   ⍝Returns zero indices when flowing off edge[3]   ⍝16 Jul and 19 Oct 2010 and 23 Nov 2010: work correctly![4]   ⍝30 Nov 2010: Pass through 0 arguments[5]   ⍝26 Jan 2011: and do it less cleverly so it actually works[6]   ⍝19 Feb 2011: oops...it was still wrong. Fixed.[7]   [8]   [9]   [10]   I←(¯2↑1 1,⍴I)⍴I[11]   Z←I×0[12]   →(0∊I)/0[13]   Z←((¯2↑1 1,⍴I)⍴I)+(fd⍪0)[fd[;1]⍳F SCATI I;2 3][14]   Z←Z×⍉(⌽⍴Z)⍴~^/I=Z[15]   Z←Z×⍉(⌽⍴Z)⍴~(∨/Z≤0)∨∨/Z>(⍴Z)⍴⍴F    ∇