    ∇ Z←W WRAP X;I;P;T;J;N[1]   ⍝Wrap lines of character matrix ⍵ no wider than ⍺[1], use hanging indent ⍺[2][2]   ⍝Wrap on spaces if possible[3]   ⍝B. Compton, 24 Jan 2014[4]   ⍝11 Feb 2014: pass through empty string[5]   [6]   [7]   [8]    ⍎(0=⎕NC'W')/'W←⎕PW'                ⍝Defaults: width is ⎕PW, hanging indent is 0[9]    Z←0 0⍴'' ⋄ →(0∊⍴X)/0[10]   W N ← 2↑W[11]   X←↓(¯2↑1,⍴X)⍴X[12]  [13]   I←1[14]  L1:T←+/∨\' '=⌽↑(W-N)↑¨X             ⍝While length of next part, breaking on space[15]   T[(T=0)/⍳⍴T]←W-N                   ⍝   where that gets us nothing, break at end[16]   P←MIX T↑¨X[17]   X←T↓¨X                             ⍝   remainder[18]   →(^/,P=' ')/L1[19]   :if I=1                            ⍝   if first part,[20]      Z←P[21]   :else                              ⍝   else,[22]      Z←((1↑⍴Z),T←(1↓⍴Z)⌈N+1↓⍴P)↑Z    ⍝      Conform widths[23]      P←((1↑⍴P),T)↑(((1↑⍴P),N)⍴' '),P[24]      J←(I×1↑⍴P)⍴⍳I                   ⍝      Figure out rows[25]      Z←(J≠I)⍀Z[26]      Z[(J=I)/⍳1↑⍴Z;]←P               ⍝      insert next line[27]   :end[28]   I←I+1[29]   →(∨/' '≠⊃,/X)/L1                   ⍝If not done, repeat[30]   Z←FRDBL (∨/Z≠' ')⌿Z    ∇