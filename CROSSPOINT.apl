    ∇ Z←P CROSSPOINT S;I;U;B1;B2;A1;A2;XI;YI[1]   ⍝Return x,y of crossing point(s) in any line segment in ⍵ crossed by line segment ⍺[2]   ⍝Also passes columns 5-1↓⍴⍵ for crossed segments[3]   ⍝Source: http://www.geog.ubc.ca/courses/klink/gis.notes/ncgia/u32.html#SEC32.3.4[4]   ⍝B. Compton, 18 Mar 2010, from CROSS[5]   ⍝17 Feb 2010: deal with orthogonal lines[6]   ⍝5 Aug 2010: return extra columns in S[7]   [8]   [9]    Z←(0,¯2+1↓⍴S)⍴0[10]   I←0[11]  L1:→((1↑⍴S)<I←I+1)/0[12]   U←2 2⍴S[I;⍳4][13]   U[1;]←U[1;]+1E¯2×=⌿U            ⍝Knock lines out of perfect horizontal/vertical to avoid ÷0[14]   P[1;]←P[1;]+1E¯2×=⌿P[15]   B1←(-/P[2 1;2])÷-/P[2 1;1][16]   B2←(-/U[2 1;2])÷-/U[2 1;1][17]   A1←P[1;2]-B1×P[1;1][18]   A2←U[1;2]-B2×U[1;1][19]   XI←-(A1-A2)÷B1-B2+.0001×B1=B2   ⍝Add tiny number if lines are parallel[20]   YI←A1+B1×XI[21]   Z←Z⍪((((P[1;1]-XI)×XI-P[2;1])≥0)^(((U[1;1]-XI)×(XI-U[2;1]))≥0)^(((P[1;2]-YI)×YI-P[2;2])≥0)^((U[1;2]-YI)×YI-U[2;2])≥0)⌿XI,YI,0 4↓S[,I;][22]   →L1    ∇