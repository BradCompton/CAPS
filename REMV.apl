    ∇ Z←S REMV A;I;M;Q[1]   ⍝Replace values in ⍵ corresponding with MVs in any ⍺ with correct MV[2]   ⍝Allows multiple MV types in global MV (e.g., NODATA, developed, etc.)[3]   ⍝Matrices must conform.  ⍺ may be nested vector of matrices.  In case[4]   ⍝of MV conflict among ⍺ grids, earlier entries in MV list prevail.[5]   ⍝16 Feb 2006: passes scalars through - they must not be missing[6]   ⍝29 Aug 2012: in simple cases, call MVREP instead[7]   ⍝  *** I'm not convinced we usually want this; I bet we could usually use MVREP directly[8]   [9]   [10]  [11]   →(0=⍴⍴Z←A)/0[12]  [13]   →((1<≡S)∨1<⍴,MV)/L0    ⍝If simple case (one ⍺ and one kind of missing value),[14]   Z←MVREP A (S=MV)       ⍝   Do it fast[15]   →0[16]  [17]  L0:M←,MV[18]   →(1≥≡S)/L1             ⍝If ⍺ contains multiple matrices,[19]   S←(0≠⊃,/⍴¨⍴¨S)/S       ⍝   Scalars are excluded for MV replacement[20]   S←,(1+⍴M)|⌊⌿M⍳↑S       ⍝   Combine grids[21]   →L2[22]  L1:S←,(1+⍴M)|M⍳S        ⍝Else, just have one[23]  L2:Z←(×/⍴A)⍴A[24]   I←0[25]  L3:→((⍴M)<I←I+1)/L4     ⍝For each missing value type,[26]   Z[(S=I)/⍳⍴Z]←M[I]      ⍝   replace MV in result[27]   →L3[28]  L4:Z←(⍴A)⍴Z    ∇