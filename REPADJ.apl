    ∇ Z←X REPADJ Y;V;I;J[1]   ⍝Replace values in ⍺ indexed by 1⊃⍵ with 2⊃⍵ (like SCATR) but also replace adjacent cells that have same value[2]   ⍝B. Compton, 8-11 Aug 2011[3]   [4]   [5]   [6]    Y V ← Y[7]    V←(1↑⍴Y)⍴V[8]    Z←0,(0⍪X⍪0),0[9]    Y←Y+1[10]   I←0[11]  L1:→((1↑⍴Y)<I←I+1)/L2                                               ⍝For each cell to replace,[12]   J←1 2⍴0 ⋄ →(Z[Y[I;1];Y[I;2]]∊0,MV)/L3                              ⍝   don't replace neighbors of cells with 0 or MV[13]   J←¯2+INDICES Z[Y[I;1];Y[I;2]]=Z[Y[I;1]+¯1 0 1;Y[I;2]+¯1 0 1]       ⍝   find neighbors with same value[14]  L3:Z←Z SCATR (J+(⍴J)⍴Y[I;]) (V[I])                                  ⍝   replace them all[15]   →L1[16]  L2:Z←1 1↓¯1 ¯1↓Z    ∇