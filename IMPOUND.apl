    ∇ Z←D IMPOUND I;J[1]   ⍝Guts of impoundment metric for outflow ⍵ and elevation of next dam ⍺[2]   ⍝Globals:[3]   ⍝   dams        1 for dams[4]   ⍝   strflow     D8 flow grid for centerlines only[5]   ⍝   dem         elevation[6]   ⍝   result      result grid[7]   ⍝B. Compton, 2-3 and 8 Jun 2011[8]   [9]   [10]  [11]   ⍎(0=⎕NC'D')/'D←MV'[12]  [13]  ⍎(1E6<1↑⍴⎕SI)/'STOP!'[14]  [15]   →(~dams[I[1];I[2]])/L1                 ⍝If there's a dam here,[16]   J←strflow FLOWINTO I                   ⍝   Upstream cells[17]   D←⌊/dem SCATI J                        ⍝   Get min elevation of cells flowing into dam[18]  [19]  L1:→(D=MV)/L2                           ⍝If we're above a dam,[20]   result[I[1];I[2]]←dem[I[1];I[2]]-D     ⍝   Raw result is height above dam[21]  [22]  L2:→(0∊⍴I←strflow FLOWINTO I)/0         ⍝   If any stream centerlines cells flow into this one,[23]   D IMPOUND¨↓I                           ⍝      Recurse    ∇