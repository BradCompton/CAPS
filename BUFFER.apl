    ∇ Z←N BUFFER X;Y;I;E;C;M;K;J;L[1]   ⍝Buffer ⍵ by ⍺ (default=1) cells[2]   ⍝New version: buffers corners correctly at any scale[3]   ⍝Buffers all non-zero/non-missing cells, returning binary result[4]   ⍝Comes out the same as the old 4-neighbor version when buffering one cell[5]   ⍝Does not expand grid--do that yourself if you want it[6]   ⍝B. Compton, 25 Jun 2012[7]   [8]   [9]   [10]   ⍎(0=⎕NC'N')/'N←1'[11]   X←(-N+⍴X)↑X←((N←⌈N)+⍴X)↑~X∊0,MV                    ⍝Expand so buffer will always fit[12]   Y←X[1⊃L;2⊃L←N CLIP X]                              ⍝Pull out non-zero stuff with buffer[13]   E←Y^(~1⌽Y)∨(~¯1⌽Y)∨(~1⊖Y)∨~¯1⊖Y                    ⍝Edge cells[14]   C←N≥DIST 1+N×2                                     ⍝Make a circle[15]   M←((,E)/,⍉(⌽⍴E)⍴⍳1↑⍴E),[1.5](,E)/,(⍴E)⍴⍳1↓⍴E       ⍝I,J of edge cells[16]   J←(⍳1+2×N)-N+1                                     ⍝Circle indices[17]  [18]   I←0[19]  L1:→((1↑⍴M)<I←I+1)/L2                               ⍝For each edge cell,[20]   Y[M[I;1]+J;M[I;2]+J]←Y[M[I;1]+J;M[I;2]+J]⌈C        ⍝   include circle[21]   →L1[22]  [23]  L2:X[1⊃L;2⊃L]←Y[24]   Z←(-2⍴N)↓(2⍴N)↓X    ∇