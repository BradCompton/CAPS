    ∇ Z←R FINDPATCH X;R;N;Q;err[1]   ⍝Id all patches in ⍵ using ⍺-neighbor rule.  Fast C version.[2]   ⍝   aplc - if 1, APL version; if 2, C version[3]   ⍝Note: ignores zero-valued cells; also treats negative patches as background[4]   ⍝B. Compton/E. Ene, 4 Jun 2012[5]   [6]   [7]   [8]    ⍎(0=⎕NC'R')/'R←8'[9]    →(aplc=1)/L2                   ⍝If C version,[10]   →(^/3=⎕NC'FINDPATCHc')/L1      ⍝   If not loaded,[11]   Q←⎕EX 'FINDPATCHc'[12]   ⎕ERROR REPORTC 'DLL I4←CAPS_LIB.patch_scan(*I4←,I4,I4,I4,I4,*I4←)' ⎕NA 'FINDPATCHc'[13]  ⍝⎕←'CAPS_LIB.patch_scan loaded.'[14]  [15]  L1:N←0[16]   X←MVREP X (X=0)[17]   err Z N ← FINDPATCHc X (1↑⍴X) (1↓⍴X) R MV N[18]   ⎕ERROR REPORTC err[19]   Z←0 MVREP (Z+1) (Z=MV)         ⍝Return 0 for non-patches, then patches are numbered from 1[20]   →0[21]  [22]  L2:Z←FINDPATCH_A X    ∇