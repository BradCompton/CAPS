    ∇ Z←PARSEDATE D;A;T;M[1]   ⍝Parse date in NOW format into ⎕TS format[2]   ⍝B. Compton, 14 Apr 2011[3]   ⍝Return 0 if date is '0'[4]   ⍝Don't fail if seconds are missing[5]   [6]   [7]   [8]    Z←0 ⋄ →((0∊⍴D)∨D≡,'0')/0[9]    A←(7 0⌈⍴A)↑A←MATRIFY '.,. .:. ' TEXTREPL D[10]   A[6+(⊂FRDBL TOUPPER A[6;])∊'AM' 'PM';]←A[6;] ⍝If no seconds, put AM/PM in the right place[11]   Z←7⍴0[12]   Z[1]←(2000×T<1900)+T←⎕FI A[3;]             ⍝Pull out year; convert to 4 digits if necessary[13]   M←MATRIFY 'January February March April May June July August September October November December'[14]   Z[2]←(M COL A[2;])⌈M[;⍳3] COL A[2;]        ⍝Month, either full name or 3-letter abbreviation[15]   Z[3]←⎕FI A[1;]                             ⍝Day[16]   Z[4]←(¯12×(T=12)^1↑'am' COL A[7;])+(12×(T≠12)^1↑'pm' COL A[7;])+T←⎕FI A[4;]       ⍝Hour, am or pm; or 24 hour time with am/pm omitted[17]   Z[5]←⎕FI A[5;]                             ⍝Minutes[18]   Z[6]←⎕FI A[6;]                             ⍝Seconds    ∇