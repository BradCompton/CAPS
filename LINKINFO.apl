    ∇ Z←LINKINFO X;pars;N;T;U;W;C;D;units;bandwidth;V;Q;R;K;M;B;inflate;pathR;pathT;pathI;A[1]   ⍝Return info for unit ⍵[2]   ⍝Results are ∆PC, and for each internode:[3]   ⍝   from-node       starting node name or number[4]   ⍝   to-node         ending node[5]   ⍝   npaths          number of paths through unit between these nodes[6]   ⍝   P(connect)      P(connect) from this distance[7]   ⍝   realized P(c)   realized P(connect) - may differ from P(connect) because of stepping stones[8]   ⍝   ∆P(connect)     delta P(connect)[9]   ⍝   realized ∆P(c)  realized delta P(connect)[10]  ⍝Results may include internodes that don't involve unit because of stepping stones.[11]  ⍝B. Compton, 31 Jan 2013 (from SINGLELINKS)[12]  ⍝11 Feb 2013: new path scheme[13]  ⍝1 Apr 2013: call FLOYDP before PC[14]  ⍝8 Apr 2013: update in line with SINGLELINKS and MANYLINKS to take mean(P(distance))[15]  [16]  [17]  [18]   SETPATHS[19]   pars←NREAD pathI PATH 'parameters.par'[20]   READPARS 'singlelinks'                         ⍝Use parameters from SINGLELINKS (need units and bandwidth)[21]  [22]   N←0 1 TABLE pathQ,'tables\nodes.txt'           ⍝List of all nodes[23]   T←0 1 TABLE pathQ,'tables\nodevalues.txt'      ⍝and get IEI-weighted size of each node[24]   N[;5]←T[T[;4]⍳N[;1];5]                         ⍝which we'll use for node importance[25]   A←(⊂'.''.') TEXTREPL¨N[;4],¨(⊂' ('),¨(⍕¨N[;1]),¨')'    ⍝Use unit names if available[26]   W←MATIN pathQ,'tables\unitindex.txt'           ⍝Unit-internode index[27]   C←D←MATIN pathQ,'tables\distance',(⊃KNAMES bandwidth←bandwidth×1000),'.txt'     ⍝Read distance matrix[28]   U←(⍴C)⍴0[29]   Z←0 5⍴0[30]   V←N[;1 5] PC FLOYD D                           ⍝Fill out probability matrix and calculate P(C) for unmodified landscape[31]   Q←(W[;1]∊X)⌿W[;2 3]                            ⍝internodes affected[32]   →(0∊⍴Q)/0                                      ⍝If no paths affected on these units, exit[33]   Q←Q[⍋Q;][34]   Q←(∨/Q≠0⍪¯1 0↓Q)⌿Q                             ⍝unique internodes[35]   R←C                                            ⍝original distance/probability matrix[36]   K←0[37]  L2:→((1↑⍴Q)<K←K+1)/L4                           ⍝For each internode,[38]   M←MATIN pathQ,'tables\',(⍕Q[K;1]),'-',(⍕Q[K;2]),'edges.txt' ⍝      read edges file[39]   U[N[;1]⍳Q[K;1];N[;1]⍳Q[K;2]]←+/M[;2]=X         ⍝   Number of paths through unit[40]   →(~units ≡ 'passages')/L3                      ⍝   If units are passages,[41]   B←M[;1]≠0,¯1↓M[;1][42]   R[N[;1]⍳Q[K;1];N[;1]⍳Q[K;2]]←5 ROUND MEAN bandwidth GAUSS (B/M[;3])-B pSUM M[;4]×M[;2]=X   ⍝         shorten distance by additional passage (round as in LINKTABLES)[43]   →L2                                            ⍝   Else, units are development,[44]  L3:R[N[;1]⍳Q[K;1];N[;1]⍳Q[K;2]]←5 ROUND MEAN bandwidth GAUSS (M[;1]≠0,¯1↓M[;1])/M[;3]×~M[;2]=X  ⍝         pay the piper: (+/not dropped)÷⍴all[45]   →L2[46]  [47]  L4:Q←-inflate×(÷V)×V-N[;1 5] PC FLOYD R          ⍝normalized delta P(C) × inflate for these nodes[48]   Z←(,⍉(⌽⍴D)⍴A),(,(⍴D)⍴'→',¨⍕¨A),(,U),(,5 ROUND D),(,5 ROUND FLOYD D),8 ROUND -(,D-R),[1.5],(FLOYD D)-FLOYD R[49]   Z[;2↓⍳1↓⍴Z]←5 ROUND Z[;2↓⍳1↓⍴Z][50]   Z←(∨/Z[;6 7]≠0)⌿Z[51]   Z←Z[⍒Z[;3];]                                   ⍝sort by npaths[52]   Z←BLANK (FRDBL¨↓'.' MATRIFY 'from-node.to-node.npaths.P(connect).realzed P(c).∆P(connect).realized ∆P(c)')⍪Z[53]   ⎕←'Unit #',(⍕X),', ∆PC = ',⍕3 ROUND Q    ∇