    ∇ RAMSAMPLE2007 W;E;X;Y;U;D;T;M;qt;qtiles;head[1]   ⍝Process Theresa's sampling plots[2]   ⍝RAMPOINTS 1 → create random points[3]   ⍝&r ramsample[4]   ⍝RAMPOINTS 2 → process results[5]   ⍝B. Compton, 23 Jul 2007[6]   ⍝2007 VERSION[7]   [8]   [9]   →(1 2=W)/L1,L2[10]  [11]  L1:⍝Create random points for ramsample.aml[12]   E←62742 110861 860617 930242[13]   X←E[1]+(UNIFORM 1E5)×(E[2]-E[1])[14]   Y←E[3]+(UNIFORM 1E5)×(E[4]-E[3])[15]   (X,[1.5]Y) MATOUT 'D:\ETC\RAM\PTS.TXT'[16]   →0[17]  [18]  L2:X←MATIN 'D:\etc\RAM\sample.txt'[19]   X←0 1↓X                            ⍝X is X, Y, IEI, type, area[20]   X←(~(FRDBL¨X[;5])≡¨⊂'MISSING')⌿X[21]   X←(~(FRDBL¨X[;4])≡¨⊂'MISSING')⌿X[22]  [23]   X[;3]←⎕FI ,' ',MIX X[;3][24]   X[;4]←⎕FI ,' ',MIX X[;4][25]   X[;5]←⎕FI ,' ',MIX X[;5][26]  [27]   X[;4]←(X[;4]=12)+2×X[;4]∊14 15 16  ⍝1 = SS, 2 = FOWET[28]   X←(X[;4]∊1 2)⌿X[29]  [30]   X[;3]←10×10 QUANTILE X[;3]         ⍝Deciles of IEI (0-9)[31]   X[;5]←1+6×6 QUANTILE X[;5]         ⍝6 size groups[32]   X←X,(10×X[;5])+X[;3]               ⍝Digits: size class, IEI[33]  [34]   Y←X[35]  [36]  L3:X←Y,UNIFORM 1↑⍴Y[37]   X←X[⍋X[;6 7];]                     ⍝Sort by class & random number[38]  [39]   U←((X[;6]⍳X[;6])=⍳1↑⍴X)/X[;6][40]   X←X,⊃,/⍳¨+⌿X[;6]∘.=U               ⍝Index[41]   X←(X[;8]≤10)⌿X                     ⍝Pick 10 points[42]  [43]   D←(((X[;1]∘.-X[;1])*2)+(X[;2]∘.-X[;2])*2)*.5[44]   D←((⍳1↑⍴X)∘.<⍳1↑⍴X)×D<500          ⍝Points within 500 m of others[45]   X←(~∨⌿D)⌿X                         ⍝Drop subsequent points that are too close[46]  [47]   U←((X[;6]⍳X[;6])=⍳1↑⍴X)/X[;6][48]   X[;8]←⊃,/⍳¨+⌿X[;6]∘.=U             ⍝Re-index[49]   X←(X[;8]≤5)⌿X                      ⍝Pick 5 points[50]  [51]   ⎕←'Number in each SS/FOWET: ',⍕T←+⌿(⍉(2,1↑⍴X)⍴X[;8]=1)^X[;4]∘.=1 2[52]   →(∨/T<20)/L3                       ⍝Try again if need be[53]  [54]   ⎕←'Number in 1,2,...,5: ',⍕T←+⌿X[;8]∘.=⍳5[55]   →(T[1]<60)/L3[56]  [57]   head←1↓⎕TCHT MTOV MATRIFY 'x-coord y-coord type size IEI code index'[58]   X←X[;1 2],('SS' 'FOWET'[X[;4]]),X[;5 3 6 8][59]   X TMATOUT T←'d:\etc\ram\rampoints.txt'[60]   ⎕←'Points written to ',T    ∇