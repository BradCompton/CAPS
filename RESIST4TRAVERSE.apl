    ∇ A RESIST4TRAVERSE S;X;W;Q;R;P;F;H;B;Z;M[1]   ⍝Build resistance grid for traversability for TNC's resilience - used for resilience impact[2]   ⍝Source:[3]   ⍝   esmplus     our landcover[4]   ⍝   trans       transmission lines, from Melissa (2 May 2017; must keep secret)    [5]   ⍝   industrial  industrial forests, from Melissa (2 May 2017)[6]   ⍝   nlcd_imp    TNC's LC_NLCD_2011_Imp, from Melissa (2 May 2017)[7]   ⍝   ecoregion   our ecoregions[8]   ⍝Results:[9]   ⍝   tresist     resistance for traversability, baseline[10]  ⍝To run for future timesteps, make following changes:[11]  ⍝   Developed- low intensity	   8[12]  ⍝   Developed- medium intensity	   9[13]  ⍝   Developed- high intensity	  20[14]  ⍝NOTE: it would be wise to run this on a single thread on W00[15]  ⍝B. Compton, 9 May 2017[16]  ⍝16 May 2017: max tracks at 8, so development & roads don't make it silly-high (Trump gives highly classified intel to Russians--something new every day)[17]  ⍝14 Jun 2017: oops! Use the mask![18]  [19]  [20]  [21]   READPARS ME[22]   X←READ GRIDNAME 1⊃1⊃A              ⍝Read landcover[23]   M←READ GRIDNAME 'mask'[24]   X←MVREP X (M≠1)[25]   [26]  ⍝Do resistance for open water: 1 for <200 m from shore, 3 for 200-400 m, 5 for >400 m [27]   W←X∊LOOK 'open water'[28]   Q←(⌊.5+200÷cellsize) BUFFER ~W     ⍝Buffer water 200 m[29]   R←(⌊.5+400÷cellsize) BUFFER ~W     ⍝and 400 m[30]   W←W×W+Q+R                          ⍝1 for > 400 m, 2 for 200-400 m, and 3 for <200 m in open water[31]   W←0 5 3 1[W+1]                     ⍝resistance for open water[32]   [33]  [34]  ⍝Do powerlines/pipelines: resistance = 9[35]   Q←MV≠READ GRIDNAME 2⊃1⊃A           ⍝Read powerline/pipelines[36]   Q←EXPAND Q                         ⍝Buffer then 1 cell[37]   R←X∊LOOK 'Shrubland & grassland (NLCD 52/71)'[38]   P←9×R^Q                            ⍝Resistance for powerlines that fall in our shrubland[39]   [40]  [41]  ⍝Do forests, including industrial forest: resistance = 1 (non-IF), 1.5 (protected IF), or 3 (IF)[42]   Q←0 MVREP READ GRIDNAME 3⊃1⊃A      ⍝Read industrial forest grid (1 = industrial forest, 2 = IF on secured land)[43]   Q←EXPAND Q                         ⍝Buffer 1 cell[44]   F←X∊LOOK 'Forested'                ⍝Anything we have as forest, including forested wetlands[45]   F←F×1 3 1.5[Q+1]                   ⍝Resitance for forests[46]   [47]     [48]  ⍝Do hay/pasture: Coastal Plain & Piedmont = 3, Mountains = 5[49]   Q←0 MVREP READ GRIDNAME 4⊃1⊃A      ⍝Read ecoregions[50]   Q←Q∊17016 17010 17025 17006 17008 17021 ⍝Mountain ecoregions[51]   H←X∊LOOK 'Pasture/hay'[52]   H←H×3 5[Q+1]                       ⍝Resistance for hayfields[53]  [54]  [55]  ⍝Do barren land: natural = 1, non-natural = 9[56]   Q←31=READ GRIDNAME 5⊃1⊃A           ⍝Read TNC's improved landcover; 31 = barren non-natural[57]   Q←EXPAND Q[58]   B←X∊LOOK 'Barren land'             ⍝Barren land[59]   B←B×1 9[Q+1]                       ⍝Resistance for barren land[60]   [61]   [62]  ⍝Now apply crosswalk for everything else[63]   Z←(⍴X)⍴1                           ⍝Everything natural gets a resistance of 1[64]   Z←0 MVREP Z (0≠W+P+F+H+B)          ⍝Except the stuff we've already done--those get zero[65]   Z←8 MVREP Z (X∊⊃,/LOOK¨ 'Developed- open space' 'Developed- low intensity')[66]   Z←9 MVREP Z (X=LOOK 'Developed- medium intensity')[67]   Z←20 MVREP Z (X=LOOK 'Developed- high intensity')[68]   Z←7 MVREP Z (X=LOOK 'Cultivated crops')[69]   Z←20 MVREP Z (X∊⊃,/LOOK¨'Motorway' 'Primary road' 'Secondary road' 'Tertiary road')[70]   Z←10 MVREP Z (X=LOOK 'Local road')[71]   Z←9 MVREP Z (X∊⊃,/LOOK¨'Active train' 'Abandoned train')[72]   [73]   Z←Z+W+P+F+H+B                      ⍝Add in the stuff we've already done[74]   [75]   [76]   [77]  ⍝Finally, replace tracks with focal majority + 1[78]   Q←X∊LOOK 'Track'[79]   Z←Z⌈Q×8⌊1+FOCALMAJORITY Z×~Q       ⍝Resistance for tracks--but never increase beyond low-intensity development[80]  [81]  [82]   Z←MVREP Z (X=MV)                   ⍝Set to nodata where landcover is nodata[83]   Z WRITE 3⊃A[84]   →0[85]   [86]   [87]  [88]  what:data prep[89]  type:standard[90]  info:('land' 'trans' 'industrial' 'ecoregions' 'nlcd_imp') ('') ('tresist') 1 'mask'      ⍝Source grid, settings table, result grid, buffer size, and include grid[91]  check:CHECKVAR ''    ∇