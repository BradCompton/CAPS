    ∇ Z←P SA_SCORE X;cost;cellsize[1]   ⍝Scoring function for SA[2]   [3]   [4]    cost←3 2⍴¯1 1 1 1 0 1[5]    cellsize←1[6]   ⍝ Z←X×P KERNEL X     ⍝Score for each cell, using kernel (max of 1)[7]   ⍝ →L9[8]   [9]     X←0,0⍪(X⍪0),0[10]   ⍝  Z←(÷4)×(1⌽X)+(1⊖X)+(¯1⌽X)+(¯1⊖X)    ⍝Number of orthogonal neighbors[11]   Z←(÷9.6)×(1⌽X)+(1⊖X)+(¯1⌽X)+(¯1⊖X)+1.4×(1⌽1⊖X)+(¯1⌽1⊖X)+(1⌽¯1⊖X)+¯1⌽¯1⊖X    ⍝Number of neighbors[12]    Z←(÷76.8)×(1⌽Z)+(1⊖Z)+(¯1⌽Z)+(¯1⊖Z)+1.4×(1⌽1⊖Z)+(¯1⌽1⊖Z)+(1⌽¯1⊖Z)+¯1⌽¯1⊖Z    ⍝Scores of neighbors[13]    Z←1 1↓¯1 ¯1↓Z[14]  [15]  L9:  Z←Z×iei[16]   ⍝     Z←Z×(T-(⍴Z)↑DIST T)÷T←⌈/⍴Z[17]      ∇