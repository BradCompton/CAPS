    ∇ S SETWINDOW G;Q;T[1]   ⍝Sets grid access window to grid ⍵; ignore window already set if ⍺[2]   ⍝Sets gridwindow to cols, rows, xll, yll, cellsize, nodata, blockonly (1 if no caching)[3]   ⍝B. Compton, 10-12 Sep 2013[4]   ⍝5 Nov 2013: also work with grids[5]   ⍝3 Jan 2014: use MOSAICINFO instead of GRIDDESCRIBE to test for mosaics; 6 Jan: do it right[6]   [7]   [8]   [9]    ⍎(0=⎕NC'S')/'S←0'[10]   ⎕ERROR (0=⎕NC 'connections')/'No connections have been set'[11]   ⎕ERROR (activeconnection[1]∊0,MV)/'There is no active connection'[12]   ⎕ERROR (connections[activeconnection[1];connections_ COL 'set']^~S)/'The access window for the active connection is already set'[13]   :if ~(2⍴⊂⍳0)≡Q←MOSAICINFO G                    ⍝If grid is a mosaic,[14]      T←∆MAKEWINDOW 5↑⊃(⊃Q)[(2⊃Q) COL 'extent']   ⍝   make window matching mosaic[15]   :else                                          ⍝else, it's a grid,[16]      S ∆SETWINDOW G                              ⍝   Set new window[17]   :end[18]   Q←CHECKWINDOW gridwindow 1                     ⍝Check it[19]   :if 0=1⊃Q                                      ⍝If window does't check out,[20]      ∆CLEANUP[21]      ∆GRIDINIT connections[activeconnection[1];connections_ COL 'server port log'][22]      ⎕ERROR 'New window doesn''t align with prior windows: ',2⊃Q[23]   :end[24]   connections[activeconnection[1];connections_ COL 'window']←⊂gridwindow[25]   :if 0∊⍴referencewindow[26]      referencewindow←5↑gridwindow[27]      workingcellsize←CELLSIZE[28]   :end    ∇